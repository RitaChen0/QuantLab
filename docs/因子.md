# QuantLab å› å­åº«å®Œæ•´åƒè€ƒ

> æœ¬æ–‡æª”æä¾› QuantLab ç³»çµ±ä¸­æ‰€æœ‰å¯ç”¨å› å­ã€æŒ‡æ¨™å’Œè³‡æ–™çš„å®Œæ•´æ¸…å–®
> æœ€å¾Œæ›´æ–°ï¼š2025-12-13

---

## ç›®éŒ„

1. [ç³»çµ±æ•´é«”æ¦‚æ³](#ç³»çµ±æ•´é«”æ¦‚æ³)
2. [å¯¦éš›è³‡æ–™ vs è¨ˆç®—å¼•æ“Žå°ç…§è¡¨](#å¯¦éš›è³‡æ–™-vs-è¨ˆç®—å¼•æ“Žå°ç…§è¡¨)
3. [Alpha158 å› å­åº«è©³ç´°èªªæ˜Ž](#alpha158-å› å­åº«è©³ç´°èªªæ˜Ž)
4. [Backtrader æŠ€è¡“æŒ‡æ¨™](#backtrader-æŠ€è¡“æŒ‡æ¨™)
5. [Qlib è¡¨é”å¼å› å­](#qlib-è¡¨é”å¼å› å­)
6. [åŸºæœ¬é¢è²¡å‹™æ•¸æ“š](#åŸºæœ¬é¢è²¡å‹™æ•¸æ“š)
7. [ç”¢æ¥­èšåˆæŒ‡æ¨™](#ç”¢æ¥­èšåˆæŒ‡æ¨™)
8. [å›žæ¸¬ç¸¾æ•ˆæŒ‡æ¨™](#å›žæ¸¬ç¸¾æ•ˆæŒ‡æ¨™)

---

## ç³»çµ±æ•´é«”æ¦‚æ³

QuantLab æä¾›äº† **300+ å€‹å¯ç”¨å› å­å’ŒæŒ‡æ¨™**ï¼Œåˆ†ç‚ºä»¥ä¸‹å¹¾å¤§é¡žï¼š

### ðŸ“Š æ•¸æ“šçµ±è¨ˆç¸½è¦½

| é¡žåˆ¥ | æ•¸é‡ | ç‹€æ…‹ | è³‡æ–™é‡ |
|------|------|------|--------|
| **åŽŸå§‹è‚¡åƒ¹æ•¸æ“š** | 2,671 æª”è‚¡ç¥¨ | âœ… å·²å­˜å„² | 12,230,549 ç­† |
| **åˆ†é˜ç·šæ•¸æ“š** | 2,671 æª”è‚¡ç¥¨ | âœ… å·²å­˜å„² | 148,911,163 ç­† |
| **Qlib äºŒé€²åˆ¶æ•¸æ“š** | 6 å€‹åŸºç¤Žæ¬„ä½ | âœ… å·²å­˜å„² | 2,671 æª”è‚¡ç¥¨ |
| **åŸºæœ¬é¢æŒ‡æ¨™** | 18 å€‹è²¡å‹™æŒ‡æ¨™ | âœ… å·²å­˜å„² | 1,880,982 ç­† |
| **ç”¢æ¥­åˆ†é¡ž** | 41 å€‹ç”¢æ¥­ | âœ… å·²å­˜å„² | 1,935 ç­†æ˜ å°„ |
| **æŠ€è¡“æŒ‡æ¨™** | 50+ ç¨® | âš™ï¸ å¯¦æ™‚è¨ˆç®— | - |
| **Alpha158 å› å­** | 158-179 å€‹ | âš™ï¸ å¯¦æ™‚è¨ˆç®— | - |
| **AI ç”Ÿæˆå› å­** | 7 å€‹ç¯„ä¾‹ | âœ… å·²å­˜å„² | å¯æ“´å±• |
| **ç­–ç•¥ç¯„æœ¬** | 29 å€‹ | ðŸ“ ä»£ç¢¼ç¯„æœ¬ | - |

### ðŸŽ¯ å¿«é€Ÿå°Žèˆª

- **åˆå­¸è€…**: ä½¿ç”¨ [Backtrader ç­–ç•¥ç¯„æœ¬](#backtrader-æŠ€è¡“æŒ‡æ¨™)ï¼ˆ20å€‹ç¾æˆç­–ç•¥ï¼‰
- **é€²éšŽç”¨æˆ¶**: ä½¿ç”¨ [Qlib è¡¨é”å¼](#qlib-è¡¨é”å¼å› å­)ï¼ˆéˆæ´»çµ„åˆå› å­ï¼‰
- **å°ˆæ¥­ç ”ç©¶**: ä½¿ç”¨ [Alpha158 å› å­åº«](#alpha158-å› å­åº«è©³ç´°èªªæ˜Ž)ï¼ˆ158å€‹æ¨™æº–å› å­ï¼‰
- **AI è‡ªå‹•åŒ–**: ä½¿ç”¨ RD-Agent è‡ªå‹•ç”Ÿæˆå’Œå„ªåŒ–å› å­

---

## å¯¦éš›è³‡æ–™ vs è¨ˆç®—å¼•æ“Žå°ç…§è¡¨

### âœ… å·²æœ‰å¯¦éš›è³‡æ–™çš„éƒ¨åˆ†ï¼ˆç¾æˆå¯ç”¨ï¼‰

#### 1. åŽŸå§‹å¸‚å ´æ•¸æ“šï¼ˆæœ€é‡è¦ï¼ï¼‰

```yaml
è‚¡ç¥¨æ—¥ç·šæ•¸æ“š: 12,230,549 ç­†è¨˜éŒ„
  æ¬„ä½: open, high, low, close, volume, adj_close
  æ¶µè“‹: 2,671 æª”è‚¡ç¥¨
  æœ€æ–°æ•¸æ“š: 2025-12-11
  è³‡æ–™è¡¨: stock_prices (TimescaleDB hypertable)

1åˆ†é˜Kç·šæ•¸æ“š: 148,911,163 ç­†è¨˜éŒ„
  ä¾†æº: Shioaji (æ°¸è±è­‰åˆ¸)
  æ™‚é–“ç¯„åœ: 2018-12-07 ~ 2025-12-10ï¼ˆ7å¹´ï¼‰
  è³‡æ–™è¡¨: stock_minute_prices (TimescaleDB hypertable)

Qlib äºŒé€²åˆ¶æ•¸æ“š: 2,671 æª”è‚¡ç¥¨
  åŸºç¤Žæ¬„ä½: $open, $high, $low, $close, $volume, $factor
  æ ¼å¼: /data/qlib/tw_stock_v2/features/{è‚¡ç¥¨ä»£è™Ÿ}/*.day.bin
  å„ªå‹¢: è®€å–é€Ÿåº¦å¿« 3-10 å€
```

#### 2. åŸºæœ¬é¢è²¡å‹™æ•¸æ“šï¼ˆ1,880,982 ç­†è¨˜éŒ„ï¼‰

**18 å€‹è²¡å‹™æŒ‡æ¨™**ï¼ˆå·²å­˜åœ¨è³‡æ–™åº« `fundamental_data` è¡¨ï¼‰:

| æŒ‡æ¨™åç¨± | èªªæ˜Ž | è³‡æ–™è¡¨æ¬„ä½ |
|---------|------|-----------|
| ROAç¨…å¾Œæ¯å‰ | è³‡ç”¢å ±é…¬çŽ‡ | `indicator` = 'ROAç¨…å¾Œæ¯å‰' |
| ROEç¨…å¾Œ | è‚¡æ±æ¬Šç›Šå ±é…¬çŽ‡ | `indicator` = 'ROEç¨…å¾Œ' |
| å­˜è²¨é€±è½‰çŽ‡ | å­˜è²¨ç®¡ç†æ•ˆçŽ‡ | `indicator` = 'å­˜è²¨é€±è½‰çŽ‡' |
| æ‡‰æ”¶å¸³æ¬¾é€±è½‰çŽ‡ | æ‡‰æ”¶å¸³æ¬¾ç®¡ç†æ•ˆçŽ‡ | `indicator` = 'æ‡‰æ”¶å¸³æ¬¾é€±è½‰çŽ‡' |
| æ¯è‚¡ç‡Ÿæ¥­é¡ | æ¯è‚¡ç”¢ç”Ÿçš„ç‡Ÿæ¥­é¡ | `indicator` = 'æ¯è‚¡ç‡Ÿæ¥­é¡' |
| æ¯è‚¡ç¾é‡‘æµé‡ | æ¯è‚¡ç¾é‡‘æµé‡ | `indicator` = 'æ¯è‚¡ç¾é‡‘æµé‡' |
| æ¯è‚¡ç¨…å¾Œæ·¨åˆ© | EPS | `indicator` = 'æ¯è‚¡ç¨…å¾Œæ·¨åˆ©' |
| æµå‹•æ¯”çŽ‡ | çŸ­æœŸå„Ÿå‚µèƒ½åŠ› | `indicator` = 'æµå‹•æ¯”çŽ‡' |
| ç‡Ÿæ”¶æˆé•·çŽ‡ | ç‡Ÿæ”¶æˆé•·çŽ‡ | `indicator` = 'ç‡Ÿæ”¶æˆé•·çŽ‡' |
| ç‡Ÿæ¥­åˆ©ç›ŠçŽ‡ | ç‡Ÿæ¥­åˆ©ç›ŠçŽ‡ | `indicator` = 'ç‡Ÿæ¥­åˆ©ç›ŠçŽ‡' |
| ç‡Ÿæ¥­æ¯›åˆ©çŽ‡ | æ¯›åˆ©çŽ‡ | `indicator` = 'ç‡Ÿæ¥­æ¯›åˆ©çŽ‡' |
| ç¨…å‰æ·¨åˆ©æˆé•·çŽ‡ | ç¨…å‰æ·¨åˆ©æˆé•·çŽ‡ | `indicator` = 'ç¨…å‰æ·¨åˆ©æˆé•·çŽ‡' |
| ç¨…å‰æ·¨åˆ©çŽ‡ | ç¨…å‰æ·¨åˆ©çŽ‡ | `indicator` = 'ç¨…å‰æ·¨åˆ©çŽ‡' |
| ç¨…å¾Œæ·¨åˆ©æˆé•·çŽ‡ | æ·¨åˆ©æˆé•·çŽ‡ | `indicator` = 'ç¨…å¾Œæ·¨åˆ©æˆé•·çŽ‡' |
| ç¨…å¾Œæ·¨åˆ©çŽ‡ | æ·¨åˆ©çŽ‡ | `indicator` = 'ç¨…å¾Œæ·¨åˆ©çŽ‡' |
| ç¸½è³‡ç”¢é€±è½‰æ¬¡æ•¸ | è³‡ç”¢ä½¿ç”¨æ•ˆçŽ‡ | `indicator` = 'ç¸½è³‡ç”¢é€±è½‰æ¬¡æ•¸' |
| è² å‚µæ¯”çŽ‡ | è²¡å‹™æ§“æ¡¿ | `indicator` = 'è² å‚µæ¯”çŽ‡' |
| é€Ÿå‹•æ¯”çŽ‡ | å³æ™‚å„Ÿå‚µèƒ½åŠ› | `indicator` = 'é€Ÿå‹•æ¯”çŽ‡' |

**æŸ¥è©¢ç¯„ä¾‹**:
```sql
SELECT stock_id, indicator, date, value
FROM fundamental_data
WHERE indicator = 'ROEç¨…å¾Œ'
  AND date = '2024-Q4'
ORDER BY value DESC
LIMIT 10;
```

#### 3. ç”¢æ¥­åˆ†é¡žæ•¸æ“š

```yaml
TWSE ç”¢æ¥­åˆ†é¡ž:
  ç”¢æ¥­æ•¸é‡: 41 å€‹ï¼ˆ3å±¤éšŽå±¤ï¼šå¤§é¡ž/ä¸­é¡ž/å°é¡žï¼‰
  è³‡æ–™è¡¨: industries
  è‚¡ç¥¨æ˜ å°„: 1,935 ç­†ï¼ˆstock_industries è¡¨ï¼‰
  ä¾†æº: FinLab company_basic_info

FinMind ç”¢æ¥­éˆ:
  åˆ†é¡žæ–¹å¼: æ‰å¹³åŒ–åˆ†é¡ž
  ä¾†æº: FinMind API TaiwanStockIndustryChain
  æ¬Šé™: éœ€ä»˜è²»æœƒå“¡
```

#### 4. AI ç”Ÿæˆå› å­ï¼ˆ7 å€‹ç¯„ä¾‹å› å­ï¼‰

**è³‡æ–™è¡¨**: `generated_factors`

| å› å­åç¨± | å…¬å¼ | é¡žåˆ¥ | èªªæ˜Ž |
|---------|------|------|------|
| 20DaySMA | `Mean($close, 20)` | momentum | 20æ—¥ç°¡å–®ç§»å‹•å¹³å‡ç·š |
| 10æ—¥æˆäº¤é‡åŠ æ¬Šå¹³å‡åƒ¹æ ¼å‹•é‡ | `(Sum($close*$volume, 10) / Sum($volume, 10)) - Ref($close, 10)` | momentum | æˆäº¤é‡åŠ æ¬Šå‹•é‡ |
| ... | ... | ... | å…¶ä»– 5 å€‹å› å­ |

**è©•ä¼°æŒ‡æ¨™**:
- IC (Information Coefficient)
- ICIR (IC Information Ratio)
- Rank IC / Rank ICIR
- Sharpe Ratio
- Annual Return
- Max Drawdown
- Win Rate

---

### âš™ï¸ éœ€è¦å¯¦æ™‚è¨ˆç®—çš„éƒ¨åˆ†ï¼ˆç¯„æœ¬/å¼•æ“Žï¼‰

#### 1. æŠ€è¡“æŒ‡æ¨™ï¼ˆBacktrader/Qlibï¼‰

**ç‹€æ…‹**: âŒ ä¸æ˜¯é å…ˆè¨ˆç®—å¥½çš„
**å¯ç”¨æ€§**: âœ… å¯ä»¥ç”¨åŽŸå§‹æ•¸æ“šå¯¦æ™‚è¨ˆç®—

**å¸¸ç”¨æŠ€è¡“æŒ‡æ¨™**:
- RSI, MACD, KDJ â†’ ç”¨ `stock_prices` æ•¸æ“šè¨ˆç®—
- å‡ç·šã€å¸ƒæž—é€šé“ â†’ å¯¦æ™‚è¨ˆç®—
- ATR, ADX, Williams %R â†’ å¯¦æ™‚è¨ˆç®—

#### 2. Alpha158 å› å­åº«ï¼ˆ158-179å€‹ï¼‰

**ç‹€æ…‹**: âŒ ä¸æ˜¯é å…ˆå­˜å„²çš„
**å¯ç”¨æ€§**: âœ… æœ‰è¨ˆç®—å¼•æ“Ž (`alpha158_factors.py`)
**å„ªå‹¢**: å¯ä»¥ç”¨åŽŸå§‹æ•¸æ“šå¿«é€Ÿè¨ˆç®—

**ä½¿ç”¨ç¯„ä¾‹**:
```python
from app.services.alpha158_factors import Alpha158Calculator

calculator = Alpha158Calculator()
factors = calculator.calculate_all_factors(df)  # df æ˜¯ OHLCV æ•¸æ“š
```

#### 3. ç­–ç•¥ç¯„æœ¬ï¼ˆ29å€‹ï¼‰

**ç‹€æ…‹**: âŒ ä¸æ˜¯é å…ˆè¨ˆç®—çš„å› å­
**å¯ç”¨æ€§**: âœ… å¯åŸ·è¡Œçš„ç­–ç•¥ä»£ç¢¼ç¯„æœ¬

- Backtrader ç¯„æœ¬: 20 å€‹
- Qlib ç¯„æœ¬: 9 å€‹

---

### ðŸŽ¯ å¯¦éš›ä½¿ç”¨æµç¨‹

#### æƒ…å¢ƒ 1: ä½¿ç”¨ Qlib è¡¨é”å¼

```python
# âœ… é€™äº›æ•¸æ“šå·²ç¶“å­˜åœ¨ï¼ˆç›´æŽ¥è®€å–ï¼‰
$close        # ä¾†è‡ª Qlib äºŒé€²åˆ¶æ•¸æ“š
$open, $high, $low, $volume  # åŒä¸Š

# âš™ï¸ é€™äº›éœ€è¦å¯¦æ™‚è¨ˆç®—ï¼ˆQlib è¡¨é”å¼å¼•æ“Žï¼‰
Mean($close, 20)      # 20æ—¥å‡ç·š
Std($close, 20)       # 20æ—¥æ¨™æº–å·®
Ref($close, 5)        # 5å¤©å‰çš„æ”¶ç›¤åƒ¹
```

#### æƒ…å¢ƒ 2: ä½¿ç”¨åŸºæœ¬é¢å› å­

```python
# âœ… é€™äº›æŒ‡æ¨™å·²ç¶“åœ¨è³‡æ–™åº«ä¸­ï¼ˆç›´æŽ¥æŸ¥è©¢ï¼‰
fundamental_data è¡¨:
- ROEç¨…å¾Œ, ROAç¨…å¾Œæ¯å‰, ç‡Ÿæ¥­æ¯›åˆ©çŽ‡ç­‰ 18 å€‹æŒ‡æ¨™
- å­£åº¦æ•¸æ“šæ ¼å¼: "2024-Q1", "2024-Q2" ç­‰
```

#### æƒ…å¢ƒ 3: ä½¿ç”¨ Alpha158 å› å­

```python
# âŒ ä¸æ˜¯é å…ˆå­˜å„²çš„
# âœ… ä½†æœ‰ç¾æˆçš„è¨ˆç®—å¼•æ“Ž

# æ­¥é©Ÿï¼š
1. å¾ž stock_prices è®€å– OHLCV æ•¸æ“š
2. èª¿ç”¨ Alpha158Calculator è¨ˆç®— 158 å€‹å› å­
3. å¾—åˆ°è¨ˆç®—çµæžœï¼ˆå¯¦æ™‚ï¼Œé€Ÿåº¦å¿«ï¼‰
```

---

### ðŸ’¡ é—œéµç†è§£

**1. æœ‰"æ•¸æ“š" â‰  æœ‰"å› å­å€¼"**
- ç³»çµ±æœ‰è±å¯Œçš„**åŽŸå§‹æ•¸æ“š**ï¼ˆè‚¡åƒ¹ã€è²¡å‹™æŒ‡æ¨™ï¼‰
- ä½†æŠ€è¡“æŒ‡æ¨™å’Œ Alpha158 å› å­æ˜¯**æŒ‰éœ€è¨ˆç®—**çš„

**2. è¨ˆç®—æˆæœ¬å¾ˆä½Ž**
- Qlib äºŒé€²åˆ¶æ ¼å¼è®€å–é€Ÿåº¦å¿« 3-10 å€
- Alpha158 è¨ˆç®—å¼•æ“Žå·²å„ªåŒ–
- ä¸€æ¬¡æ€§è¨ˆç®—å¯å¿«å–çµæžœ

**3. å½ˆæ€§æ›´é«˜**
- ä¸é å…ˆè¨ˆç®—å› å­ = å¯ä»¥è‡ªç”±èª¿æ•´åƒæ•¸
- ä¾‹å¦‚ï¼šå¯ä»¥ç®— MA(10), MA(20), MA(50) ä»»æ„çµ„åˆ

---

## Alpha158 å› å­åº«è©³ç´°èªªæ˜Ž

### ðŸ“‹ å®Œæ•´æ¸…å–®ï¼ˆ158-179 å€‹æ¨™æº–å› å­ï¼‰

æ ¹æ“š `/home/ubuntu/QuantLab/backend/app/services/alpha158_factors.py` çš„å¯¦ç¾

---

### ðŸ”¹ ç¬¬ä¸€é¡žï¼šKBar å› å­ï¼ˆ9 å€‹ï¼‰- Kç·šå½¢æ…‹

**ç”¨é€”**: åˆ†æž K ç·šå¯¦é«”ã€å½±ç·šã€æ”¶ç›¤ä½ç½®ç­‰å½¢æ…‹ç‰¹å¾µ

| ä»£è™Ÿ | åç¨± | è¨ˆç®—å…¬å¼ | èªªæ˜Ž |
|------|------|---------|------|
| **KMID** | å¯¦é«”æ¯”ä¾‹ | `(close-open)/open` | å¯¦é«”ç›¸å°é–‹ç›¤åƒ¹çš„æ¯”ä¾‹ |
| **KLEN** | ç¸½æ³¢å‹•æ¯”ä¾‹ | `(high-low)/open` | å½±ç·šé•·åº¦ç›¸å°é–‹ç›¤åƒ¹ |
| **KMID2** | å¯¦é«”ä½”æ¯” | `(close-open)/(high-low)` | å¯¦é«”ä½”ç¸½æ³¢å‹•çš„æ¯”ä¾‹ |
| **KUP** | ä¸Šå½±ç·š | `(high-max(open,close))/open` | ä¸Šå½±ç·šç›¸å°é–‹ç›¤åƒ¹ |
| **KUP2** | ä¸Šå½±ç·šä½”æ¯” | `(high-max(open,close))/(high-low)` | ä¸Šå½±ç·šä½”ç¸½æ³¢å‹•æ¯”ä¾‹ |
| **KLOW** | ä¸‹å½±ç·š | `(min(open,close)-low)/open` | ä¸‹å½±ç·šç›¸å°é–‹ç›¤åƒ¹ |
| **KLOW2** | ä¸‹å½±ç·šä½”æ¯” | `(min(open,close)-low)/(high-low)` | ä¸‹å½±ç·šä½”ç¸½æ³¢å‹•æ¯”ä¾‹ |
| **KSFT** | æ”¶ç›¤ä½ç½® | `(2*close-high-low)/open` | æ”¶ç›¤åƒ¹ç›¸å°ä½ç½® |
| **KSFT2** | æ”¶ç›¤ç›¸å°ä½ç½® | `(2*close-high-low)/(high-low)` | æ”¶ç›¤åƒ¹åœ¨é«˜ä½Žé»žçš„ç›¸å°ä½ç½® |

**å®Œæ•´å› å­åç¨±**:
```
KMID, KLEN, KMID2, KUP, KUP2, KLOW, KLOW2, KSFT, KSFT2
```

---

### ðŸ”¹ ç¬¬äºŒé¡žï¼šPrice å› å­ï¼ˆ20 å€‹ï¼‰- æ­·å²åƒ¹æ ¼

**çª—å£**: `[0, 1, 2, 3, 4]` å¤©
**ç‰¹å¾µ**: `OPEN, HIGH, LOW, CLOSE` (å¯é¸ VWAP)

#### å› å­åˆ—è¡¨

| ä»£è™Ÿæ ¼å¼ | æ•¸é‡ | èªªæ˜Ž | ç¯„ä¾‹ |
|---------|------|------|------|
| **OPEN0-4** | 5 | è¿‘ 5 å¤©é–‹ç›¤åƒ¹ / ç•¶æ—¥æ”¶ç›¤åƒ¹ | `OPEN0` = ç•¶æ—¥é–‹ç›¤/æ”¶ç›¤ |
| **HIGH0-4** | 5 | è¿‘ 5 å¤©æœ€é«˜åƒ¹ / ç•¶æ—¥æ”¶ç›¤åƒ¹ | `HIGH1` = æ˜¨æ—¥æœ€é«˜/ä»Šæ—¥æ”¶ç›¤ |
| **LOW0-4** | 5 | è¿‘ 5 å¤©æœ€ä½Žåƒ¹ / ç•¶æ—¥æ”¶ç›¤åƒ¹ | `LOW2` = å‰æ—¥æœ€ä½Ž/ä»Šæ—¥æ”¶ç›¤ |
| **CLOSE0-4** | 5 | è¿‘ 5 å¤©æ”¶ç›¤åƒ¹ / ç•¶æ—¥æ”¶ç›¤åƒ¹ | `CLOSE3` = 3æ—¥å‰æ”¶ç›¤/ä»Šæ—¥æ”¶ç›¤ |

**å®Œæ•´å› å­åç¨±**:
```
OPEN0, OPEN1, OPEN2, OPEN3, OPEN4
HIGH0, HIGH1, HIGH2, HIGH3, HIGH4
LOW0, LOW1, LOW2, LOW3, LOW4
CLOSE0, CLOSE1, CLOSE2, CLOSE3, CLOSE4
```

---

### ðŸ”¹ ç¬¬ä¸‰é¡žï¼šVolume å› å­ï¼ˆ5 å€‹ï¼‰- æˆäº¤é‡

**çª—å£**: `[0, 1, 2, 3, 4]` å¤©

| ä»£è™Ÿ | è¨ˆç®—å…¬å¼ | èªªæ˜Ž |
|------|---------|------|
| **VOLUME0** | `volume / (volume + Îµ)` | ç•¶æ—¥æˆäº¤é‡æ­¸ä¸€åŒ– |
| **VOLUME1** | `volume.shift(1) / (volume + Îµ)` | æ˜¨æ—¥æˆäº¤é‡ / ä»Šæ—¥æˆäº¤é‡ |
| **VOLUME2** | `volume.shift(2) / (volume + Îµ)` | å‰æ—¥æˆäº¤é‡ / ä»Šæ—¥æˆäº¤é‡ |
| **VOLUME3** | `volume.shift(3) / (volume + Îµ)` | 3æ—¥å‰æˆäº¤é‡ / ä»Šæ—¥æˆäº¤é‡ |
| **VOLUME4** | `volume.shift(4) / (volume + Îµ)` | 4æ—¥å‰æˆäº¤é‡ / ä»Šæ—¥æˆäº¤é‡ |

**å®Œæ•´å› å­åç¨±**:
```
VOLUME0, VOLUME1, VOLUME2, VOLUME3, VOLUME4
```

---

### ðŸ”¹ ç¬¬å››é¡žï¼šRolling å› å­ï¼ˆ145 å€‹ï¼Œæ¨™æº–ç‰ˆ 124 å€‹ï¼‰

**çª—å£**: `[5, 10, 20, 30, 60]` å¤©
**æŒ‡æ¨™æ•¸é‡**: 29 å€‹ï¼ˆæ¨™æº–ç‰ˆ 25 å€‹ï¼‰

---

#### A. åƒ¹æ ¼è¶¨å‹¢æŒ‡æ¨™ï¼ˆ6 å€‹ Ã— 5 çª—å£ = 30 å€‹å› å­ï¼‰

| ä»£è™Ÿ | è‹±æ–‡åç¨± | ä¸­æ–‡èªªæ˜Ž | è¨ˆç®—é‚è¼¯ |
|------|---------|---------|---------|
| **ROC{d}** | Rate of Change | è®ŠåŒ–çŽ‡ | `close.shift(d) / close` |
| **MA{d}** | Moving Average | ç§»å‹•å¹³å‡ | `close.rolling(d).mean() / close` |
| **STD{d}** | Standard Deviation | æ¨™æº–å·® | `close.rolling(d).std() / close` |
| **BETA{d}** | Slope | ç·šæ€§å›žæ­¸æ–œçŽ‡ | `slope(close, d) / close` |
| **RSQR{d}** | R-Square | RÂ² å€¼ | `rsquare(close, d)` |
| **RESI{d}** | Residual | ç·šæ€§å›žæ­¸æ®˜å·® | `resi(close, d) / close` |

**ç¯„ä¾‹å› å­**: `ROC5, ROC10, ROC20, ROC30, ROC60, MA5, MA10, MA20, MA30, MA60, ...`

---

#### B. æ¥µå€¼æŒ‡æ¨™ï¼ˆ6 å€‹ Ã— 5 çª—å£ = 30 å€‹å› å­ï¼‰

| ä»£è™Ÿ | è‹±æ–‡åç¨± | ä¸­æ–‡èªªæ˜Ž | è¨ˆç®—é‚è¼¯ |
|------|---------|---------|---------|
| **MAX{d}** | Maximum High | Næ—¥æœ€é«˜åƒ¹ | `high.rolling(d).max() / close` |
| **MIN{d}** | Minimum Low | Næ—¥æœ€ä½Žåƒ¹ | `low.rolling(d).min() / close` |
| **QTLU{d}** | Upper Quantile | 80% åˆ†ä½æ•¸ | `close.rolling(d).quantile(0.8) / close` |
| **QTLD{d}** | Lower Quantile | 20% åˆ†ä½æ•¸ | `close.rolling(d).quantile(0.2) / close` |
| **RANK{d}** | Percentile Rank | ç™¾åˆ†ä½æŽ’å | `rank(close, d)` |
| **RSV{d}** | Relative Strength Value | ç›¸å°å¼·å¼±å€¼ | `(close-min)/(max-min)` |

**ç¯„ä¾‹å› å­**: `MAX5, MAX10, MAX20, MAX30, MAX60, MIN5, MIN10, MIN20, MIN30, MIN60, ...`

---

#### C. æ™‚é–“ä½ç½®æŒ‡æ¨™ï¼ˆ3 å€‹ Ã— 5 çª—å£ = 15 å€‹å› å­ï¼‰

| ä»£è™Ÿ | è‹±æ–‡åç¨± | ä¸­æ–‡èªªæ˜Ž | è¨ˆç®—é‚è¼¯ |
|------|---------|---------|---------|
| **IMAX{d}** | Index of Maximum | æœ€é«˜åƒ¹è·ä»Šå¤©æ•¸ | `idx_max(high, d) / d` |
| **IMIN{d}** | Index of Minimum | æœ€ä½Žåƒ¹è·ä»Šå¤©æ•¸ | `idx_min(low, d) / d` |
| **IMXD{d}** | Max-Min Index Diff | æœ€é«˜æœ€ä½Žåƒ¹æ™‚é–“å·® | `(idx_max - idx_min) / d` |

**ç¯„ä¾‹å› å­**: `IMAX5, IMAX10, IMAX20, IMAX30, IMAX60, IMIN5, IMIN10, ...`

---

#### D. ç›¸é—œæ€§æŒ‡æ¨™ï¼ˆ2 å€‹ Ã— 5 çª—å£ = 10 å€‹å› å­ï¼‰

| ä»£è™Ÿ | è‹±æ–‡åç¨± | ä¸­æ–‡èªªæ˜Ž | è¨ˆç®—é‚è¼¯ |
|------|---------|---------|---------|
| **CORR{d}** | Correlation | åƒ¹æ ¼èˆ‡æˆäº¤é‡ç›¸é—œæ€§ | `close.rolling(d).corr(log_volume)` |
| **CORD{d}** | Change Correlation | è®ŠåŒ–çŽ‡ç›¸é—œæ€§ | `close_change.rolling(d).corr(volume_change)` |

**ç¯„ä¾‹å› å­**: `CORR5, CORR10, CORR20, CORR30, CORR60, CORD5, CORD10, ...`

---

#### E. æ¼²è·Œçµ±è¨ˆæŒ‡æ¨™ï¼ˆ3 å€‹ Ã— 5 çª—å£ = 15 å€‹å› å­ï¼‰

| ä»£è™Ÿ | è‹±æ–‡åç¨± | ä¸­æ–‡èªªæ˜Ž | è¨ˆç®—é‚è¼¯ |
|------|---------|---------|---------|
| **CNTP{d}** | Count Positive | ä¸Šæ¼²å¤©æ•¸æ¯”ä¾‹ | `(close > close.shift(1)).rolling(d).mean()` |
| **CNTN{d}** | Count Negative | ä¸‹è·Œå¤©æ•¸æ¯”ä¾‹ | `(close < close.shift(1)).rolling(d).mean()` |
| **CNTD{d}** | Count Difference | æ¼²è·Œå¤©æ•¸å·® | `(up_days - down_days).rolling(d).mean()` |

**ç¯„ä¾‹å› å­**: `CNTP5, CNTP10, CNTP20, CNTP30, CNTP60, CNTN5, CNTN10, ...`

---

#### F. ç´¯ç©æ¼²è·ŒæŒ‡æ¨™ï¼ˆ3 å€‹ Ã— 5 çª—å£ = 15 å€‹å› å­ï¼‰

| ä»£è™Ÿ | è‹±æ–‡åç¨± | ä¸­æ–‡èªªæ˜Ž | è¨ˆç®—é‚è¼¯ |
|------|---------|---------|---------|
| **SUMP{d}** | Sum Positive | ç¸½ä¸Šæ¼²/ç¸½è®ŠåŒ– | `positive.sum() / abs_change.sum()` |
| **SUMN{d}** | Sum Negative | ç¸½ä¸‹è·Œ/ç¸½è®ŠåŒ– | `negative.sum() / abs_change.sum()` |
| **SUMD{d}** | Sum Difference | æ¼²è·Œå·®/ç¸½è®ŠåŒ– | `(positive-negative).sum() / abs_change.sum()` |

**ç¯„ä¾‹å› å­**: `SUMP5, SUMP10, SUMP20, SUMP30, SUMP60, SUMN5, SUMN10, ...`

---

#### G. æˆäº¤é‡çµ±è¨ˆæŒ‡æ¨™ï¼ˆ3 å€‹ Ã— 5 çª—å£ = 15 å€‹å› å­ï¼‰

| ä»£è™Ÿ | è‹±æ–‡åç¨± | ä¸­æ–‡èªªæ˜Ž | è¨ˆç®—é‚è¼¯ |
|------|---------|---------|---------|
| **VMA{d}** | Volume Moving Average | æˆäº¤é‡ç§»å‹•å¹³å‡ | `volume.rolling(d).mean() / volume` |
| **VSTD{d}** | Volume Std Dev | æˆäº¤é‡æ¨™æº–å·® | `volume.rolling(d).std() / volume` |
| **WVMA{d}** | Weighted Volume MA | åŠ æ¬Šæˆäº¤é‡ç§»å‹•å¹³å‡ | `weighted.rolling(d).std() / weighted.mean()` |

**ç¯„ä¾‹å› å­**: `VMA5, VMA10, VMA20, VMA30, VMA60, VSTD5, VSTD10, ...`

---

#### H. æˆäº¤é‡æ¼²è·Œçµ±è¨ˆï¼ˆ3 å€‹ Ã— 5 çª—å£ = 15 å€‹å› å­ï¼‰

| ä»£è™Ÿ | è‹±æ–‡åç¨± | ä¸­æ–‡èªªæ˜Ž | è¨ˆç®—é‚è¼¯ |
|------|---------|---------|---------|
| **VSUMP{d}** | Volume Sum Positive | æˆäº¤é‡ç¸½å¢žåŠ /ç¸½è®ŠåŒ– | `positive_vol.sum() / abs_vol_change.sum()` |
| **VSUMN{d}** | Volume Sum Negative | æˆäº¤é‡ç¸½æ¸›å°‘/ç¸½è®ŠåŒ– | `negative_vol.sum() / abs_vol_change.sum()` |
| **VSUMD{d}** | Volume Sum Difference | æˆäº¤é‡æ¼²è·Œå·®/ç¸½è®ŠåŒ– | `(pos_vol-neg_vol).sum() / abs_vol_change.sum()` |

**ç¯„ä¾‹å› å­**: `VSUMP5, VSUMP10, VSUMP20, VSUMP30, VSUMP60, VSUMN5, VSUMN10, ...`

---

### ðŸ“Š Rolling å› å­ç¸½æ•¸è¨ˆç®—

```
29 å€‹æŒ‡æ¨™ Ã— 5 å€‹çª—å£ = 145 å€‹ Rolling å› å­

å®Œæ•´ Alpha158+ å› å­æ•¸ï¼š
- KBar: 9
- Price: 20
- Volume: 5
- Rolling: 145
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ç¸½è¨ˆ: 179 å€‹ï¼ˆè¶…éŽæ¨™æº– 158ï¼Œç‚ºæ“´å±•ç‰ˆï¼‰

æ¨™æº– Alpha158ï¼ˆ158å€‹ï¼‰: ä½¿ç”¨ 25 å€‹ Rolling æŒ‡æ¨™ï¼ˆ25Ã—5+9+20+5-1=158ï¼‰
æœ¬å¯¦ç¾ï¼ˆ179å€‹ï¼‰: ä½¿ç”¨å…¨éƒ¨ 29 å€‹ Rolling æŒ‡æ¨™ï¼ˆæ›´å…¨é¢ï¼‰
```

---

### ðŸŽ¯ Alpha158 ä½¿ç”¨ç¯„ä¾‹

#### Python ä»£ç¢¼

```python
from app.services.alpha158_factors import Alpha158Calculator
import pandas as pd

# åˆå§‹åŒ–è¨ˆç®—å™¨
calculator = Alpha158Calculator()

# æº–å‚™æ•¸æ“šï¼ˆéœ€è¦åŒ…å«é€™äº›æ¬„ä½ï¼‰
df = pd.DataFrame({
    '$open': [...],
    '$high': [...],
    '$low': [...],
    '$close': [...],
    '$volume': [...]
})

# æ–¹æ³• 1: è¨ˆç®—æ‰€æœ‰å› å­ï¼ˆé»˜èªé…ç½®ï¼‰
result_df, factor_names = calculator.compute_all_factors(df)

# æ–¹æ³• 2: è‡ªå®šç¾©é…ç½®
config = {
    'kbar': {},  # è¨ˆç®— KBar å› å­
    'price': {
        'windows': [0, 1, 2, 3, 4],
        'feature': ['OPEN', 'HIGH', 'LOW', 'CLOSE']
    },
    'volume': {'windows': [0, 1, 2, 3, 4]},
    'rolling': {
        'windows': [5, 20, 60],  # åªç”¨ 3 å€‹çª—å£
        'include': ['ROC', 'MA', 'STD', 'MAX', 'MIN'],  # åªè¨ˆç®—ç‰¹å®šæŒ‡æ¨™
        'exclude': []
    }
}
result_df, factor_names = calculator.compute_all_factors(df, config)

# æ–¹æ³• 3: åªè¨ˆç®—ç‰¹å®šé¡žåˆ¥
result_df = calculator.compute_kbar_factors(df)  # åªç®— KBar
result_df = calculator.compute_rolling_factors(df, windows=[5, 20])  # åªç®— Rolling
```

---

### ðŸ“ å®Œæ•´ Rolling å› å­åç¨±åˆ—è¡¨ï¼ˆ145 å€‹ï¼‰

```python
# åƒ¹æ ¼è¶¨å‹¢ï¼ˆ30å€‹ï¼‰
ROC5, ROC10, ROC20, ROC30, ROC60,
MA5, MA10, MA20, MA30, MA60,
STD5, STD10, STD20, STD30, STD60,
BETA5, BETA10, BETA20, BETA30, BETA60,
RSQR5, RSQR10, RSQR20, RSQR30, RSQR60,
RESI5, RESI10, RESI20, RESI30, RESI60,

# æ¥µå€¼æŒ‡æ¨™ï¼ˆ30å€‹ï¼‰
MAX5, MAX10, MAX20, MAX30, MAX60,
MIN5, MIN10, MIN20, MIN30, MIN60,
QTLU5, QTLU10, QTLU20, QTLU30, QTLU60,
QTLD5, QTLD10, QTLD20, QTLD30, QTLD60,
RANK5, RANK10, RANK20, RANK30, RANK60,
RSV5, RSV10, RSV20, RSV30, RSV60,

# æ™‚é–“ä½ç½®ï¼ˆ15å€‹ï¼‰
IMAX5, IMAX10, IMAX20, IMAX30, IMAX60,
IMIN5, IMIN10, IMIN20, IMIN30, IMIN60,
IMXD5, IMXD10, IMXD20, IMXD30, IMXD60,

# ç›¸é—œæ€§ï¼ˆ10å€‹ï¼‰
CORR5, CORR10, CORR20, CORR30, CORR60,
CORD5, CORD10, CORD20, CORD30, CORD60,

# æ¼²è·Œçµ±è¨ˆï¼ˆ15å€‹ï¼‰
CNTP5, CNTP10, CNTP20, CNTP30, CNTP60,
CNTN5, CNTN10, CNTN20, CNTN30, CNTN60,
CNTD5, CNTD10, CNTD20, CNTD30, CNTD60,

# ç´¯ç©æ¼²è·Œï¼ˆ15å€‹ï¼‰
SUMP5, SUMP10, SUMP20, SUMP30, SUMP60,
SUMN5, SUMN10, SUMN20, SUMN30, SUMN60,
SUMD5, SUMD10, SUMD20, SUMD30, SUMD60,

# æˆäº¤é‡çµ±è¨ˆï¼ˆ15å€‹ï¼‰
VMA5, VMA10, VMA20, VMA30, VMA60,
VSTD5, VSTD10, VSTD20, VSTD30, VSTD60,
WVMA5, WVMA10, WVMA20, WVMA30, WVMA60,

# æˆäº¤é‡æ¼²è·Œï¼ˆ15å€‹ï¼‰
VSUMP5, VSUMP10, VSUMP20, VSUMP30, VSUMP60,
VSUMN5, VSUMN10, VSUMN20, VSUMN30, VSUMN60,
VSUMD5, VSUMD10, VSUMD20, VSUMD30, VSUMD60
```

---

## Backtrader æŠ€è¡“æŒ‡æ¨™

### ðŸ“Š 20 å€‹ç­–ç•¥ç¯„æœ¬åŒ…å«çš„æŠ€è¡“æŒ‡æ¨™

#### 1. è¶¨å‹¢è·Ÿéš¨æŒ‡æ¨™ï¼ˆ5 å€‹ç­–ç•¥ï¼‰

| æŒ‡æ¨™åç¨± | è‹±æ–‡åç¨± | åƒæ•¸ | ä½¿ç”¨ç­–ç•¥ |
|---------|---------|------|---------|
| **SMA** | Simple Moving Average | period=10,20,30,60 | é›™å‡ç·šã€ä¸‰å‡ç·šã€å¤šé€±æœŸ |
| **EMA** | Exponential Moving Average | period=12,26 | MACD ç­–ç•¥ |
| **ADX** | Average Directional Index | period=14 | ADX è¶¨å‹¢å¼·åº¦ |
| **DI+/DI-** | Directional Indicators | period=14 | ADX ç­–ç•¥ |
| **Highest/Lowest** | N-period High/Low | period=10,20 | å”å¥‡å®‰é€šé“ã€è¶¨å‹¢ç·šçªç ´ |

#### 2. å‡å€¼å›žæ­¸æŒ‡æ¨™ï¼ˆ5 å€‹ç­–ç•¥ï¼‰

| æŒ‡æ¨™åç¨± | è‹±æ–‡åç¨± | åƒæ•¸ | ä½¿ç”¨ç­–ç•¥ |
|---------|---------|------|---------|
| **RSI** | Relative Strength Index | period=14 | RSI åè½‰ç­–ç•¥ |
| **Williams %R** | Williams Percent Range | period=14 | å¨å»‰æŒ‡æ¨™ç­–ç•¥ |
| **StdDev** | Standard Deviation | period=20 | å‡å€¼å›žæ­¸é€šé“ |
| **Stochastic** | Stochastic Oscillator | period=9 | KDJ ç­–ç•¥ |
| **CCI** | Commodity Channel Index | period=20 | CCI ç­–ç•¥ |

#### 3. çªç ´æŒ‡æ¨™ï¼ˆ3 å€‹ç­–ç•¥ï¼‰

| æŒ‡æ¨™åç¨± | è‹±æ–‡åç¨± | åƒæ•¸ | ä½¿ç”¨ç­–ç•¥ |
|---------|---------|------|---------|
| **Bollinger Bands** | Bollinger Bands | period=20, devfactor=2.0 | å¸ƒæž—é€šé“çªç ´ |
| **Volume SMA** | Volume Moving Average | period=20 | æˆäº¤é‡çªç ´ |
| **ATR** | Average True Range | period=14 | æ³¢å‹•çŽ‡çªç ´ |

#### 4. ç¶œåˆæŒ‡æ¨™ï¼ˆ7 å€‹ç­–ç•¥ï¼‰

| æŒ‡æ¨™åç¨± | è‹±æ–‡åç¨± | åƒæ•¸ | ä½¿ç”¨ç­–ç•¥ |
|---------|---------|------|---------|
| **MACD** | Moving Average Convergence Divergence | fast=12, slow=26, signal=9 | MACD è¶¨å‹¢ |
| **CrossOver** | MA Crossover Signal | - | å‡ç·šäº¤å‰ |
| **Momentum** | Price Momentum | period=1,5 | ML é æ¸¬æ¨¡åž‹ |
| **åœæåœåˆ©** | Stop Loss/Take Profit | stop_loss=5%, take_profit=15% | åœæåœåˆ©ç­–ç•¥ |

---

### ðŸ“ Backtrader ç¯„æœ¬æ–‡ä»¶ä½ç½®

**æ–‡ä»¶**: `/home/ubuntu/QuantLab/frontend/components/StrategyTemplates.vue`

**ç¯„æœ¬åˆ—è¡¨**:
1. é›™å‡ç·šäº¤å‰ç­–ç•¥ (SMA Crossover)
2. ä¸‰å‡ç·šç­–ç•¥ (Triple MA)
3. ADX è¶¨å‹¢å¼·åº¦ç­–ç•¥
4. è¶¨å‹¢ç·šçªç ´ç­–ç•¥
5. å”å¥‡å®‰é€šé“ç­–ç•¥ï¼ˆæµ·é¾œäº¤æ˜“ï¼‰
6. RSI åè½‰ç­–ç•¥
7. å¨å»‰æŒ‡æ¨™ç­–ç•¥ (Williams %R)
8. å‡å€¼å›žæ­¸é€šé“ç­–ç•¥
9. KDJ è¶…è²·è¶…è³£ç­–ç•¥
10. CCI å•†å“é€šé“æŒ‡æ¨™ç­–ç•¥
11. å¸ƒæž—é€šé“çªç ´ç­–ç•¥
12. æˆäº¤é‡çªç ´ç­–ç•¥
13. æ³¢å‹•çŽ‡çªç ´ç­–ç•¥
14. å¤šé€±æœŸç¢ºèªç­–ç•¥
15. MACD è¶¨å‹¢ç­–ç•¥
16. åœæåœåˆ©ç­–ç•¥
17. LightGBM é æ¸¬æ¨¡åž‹
18. XGBoost æ™‚åºç­–ç•¥
19. Grid Tradingï¼ˆç¶²æ ¼äº¤æ˜“ï¼‰
20. ï¼ˆå…¶ä»–æ“´å±•ç­–ç•¥ï¼‰

---

## Qlib è¡¨é”å¼å› å­

### ðŸ§  åŸºç¤Žæ¬„ä½ï¼ˆ6 å€‹ï¼‰

**ç›´æŽ¥å¯ç”¨**ï¼ˆä¾†è‡ª Qlib äºŒé€²åˆ¶æ•¸æ“šï¼‰:

| æ¬„ä½ | èªªæ˜Ž | è³‡æ–™ä¾†æº |
|------|------|---------|
| `$open` | é–‹ç›¤åƒ¹ | /data/qlib/tw_stock_v2/features/{è‚¡ç¥¨}/open.day.bin |
| `$high` | æœ€é«˜åƒ¹ | /data/qlib/tw_stock_v2/features/{è‚¡ç¥¨}/high.day.bin |
| `$low` | æœ€ä½Žåƒ¹ | /data/qlib/tw_stock_v2/features/{è‚¡ç¥¨}/low.day.bin |
| `$close` | æ”¶ç›¤åƒ¹ | /data/qlib/tw_stock_v2/features/{è‚¡ç¥¨}/close.day.bin |
| `$volume` | æˆäº¤é‡ | /data/qlib/tw_stock_v2/features/{è‚¡ç¥¨}/volume.day.bin |
| `$factor` | èª¿æ•´å› å­ | /data/qlib/tw_stock_v2/features/{è‚¡ç¥¨}/factor.day.bin |

---

### ðŸ”§ Qlib è¡¨é”å¼å‡½æ•¸ï¼ˆ15+ ç¨®ï¼‰

#### çµ±è¨ˆå‡½æ•¸

| å‡½æ•¸ | èªªæ˜Ž | ç¯„ä¾‹ |
|------|------|------|
| `Mean(expr, N)` | N æ—¥ç§»å‹•å¹³å‡ | `Mean($close, 20)` - 20æ—¥å‡ç·š |
| `Std(expr, N)` | N æ—¥æ¨™æº–å·® | `Std($close, 20)` - 20æ—¥æ³¢å‹•çŽ‡ |
| `Sum(expr, N)` | N æ—¥æ±‚å’Œ | `Sum($volume, 5)` - 5æ—¥ç¸½æˆäº¤é‡ |
| `Max(expr, N)` | N æ—¥æœ€å¤§å€¼ | `Max($high, 10)` - 10æ—¥æœ€é«˜åƒ¹ |
| `Min(expr, N)` | N æ—¥æœ€å°å€¼ | `Min($low, 10)` - 10æ—¥æœ€ä½Žåƒ¹ |
| `EMA(expr, N)` | N æ—¥æŒ‡æ•¸ç§»å‹•å¹³å‡ | `EMA($close, 12)` - 12æ—¥EMA |

#### æ™‚é–“å‡½æ•¸

| å‡½æ•¸ | èªªæ˜Ž | ç¯„ä¾‹ |
|------|------|------|
| `Ref(expr, N)` | N å¤©å‰çš„å€¼ | `Ref($close, 5)` - 5æ—¥å‰æ”¶ç›¤åƒ¹ |
| `Shift(expr, N)` | æ™‚é–“åç§» | `Shift($close, 1)` - æ˜¨æ—¥æ”¶ç›¤åƒ¹ |

#### å…¶ä»–å‡½æ•¸

| å‡½æ•¸ | èªªæ˜Ž | ç¯„ä¾‹ |
|------|------|------|
| `Greater(a, b)` | è¿”å›žè¼ƒå¤§å€¼ | `Greater($open, $close)` |
| `Less(a, b)` | è¿”å›žè¼ƒå°å€¼ | `Less($open, $close)` |

---

### ðŸ“‹ 9 å€‹ Qlib ç­–ç•¥ç¯„æœ¬

**æ–‡ä»¶**: `/home/ubuntu/QuantLab/frontend/components/QlibStrategyTemplates.vue`

| ç­–ç•¥åç¨± | æ ¸å¿ƒè¡¨é”å¼ | èªªæ˜Ž |
|---------|-----------|------|
| **å‡ç·šäº¤å‰ç­–ç•¥** | `Mean($close, 5)`, `Mean($close, 20)` | é»ƒé‡‘äº¤å‰/æ­»äº¡äº¤å‰ |
| **å‹•é‡å› å­ç­–ç•¥** | `Ref($close, 5) / $close - 1` | 5/10/20æ—¥å‹•é‡ |
| **å¸ƒæž—é€šé“ç­–ç•¥** | `Mean($close, 20)`, `Std($close, 20)` | çªç ´ä¸Šä¸‹è»Œä¿¡è™Ÿ |
| **Z-Scoreå‡å€¼å›žæ­¸** | `($close - Mean($close, 20)) / Std($close, 20)` | Z-Score < -2 è²·å…¥ |
| **å‡ç·šæ¯”çŽ‡ç­–ç•¥** | `Mean($close, 5) / Mean($close, 20)` | çŸ­é•·æœŸå‡ç·šæ¯”çŽ‡ |
| **å¤šå› å­ç¶œåˆç­–ç•¥** | å¤šå€‹å‡ç·š + MACD + å‹•é‡ + æ³¢å‹•çŽ‡ | ç¶œåˆè©•åˆ†ä¿¡è™Ÿ |
| **åƒ¹æ ¼ä½ç½®ç­–ç•¥** | `Max($high, 20)`, `Min($low, 20)` | ç›¸å°ä½ç½®è©•ä¼° |
| **æˆäº¤é‡å‹•é‡ç­–ç•¥** | `Sum($volume, 5)`, `Ref($close, 1) / $close` | æˆäº¤é‡ç¢ºèªè¶¨å‹¢ |
| **å‹•é‡åè½‰ç­–ç•¥** | å¤šé€±æœŸå‹•é‡ + è¶…è²·è¶…è³£å€ | åè½‰äº¤æ˜“ä¿¡è™Ÿ |

---

### ðŸ’¡ Qlib è¡¨é”å¼ç¯„ä¾‹

```python
# 1. ç°¡å–®ç§»å‹•å¹³å‡
"Mean($close, 20)"

# 2. å‹•é‡å› å­ï¼ˆ5æ—¥æ”¶ç›ŠçŽ‡ï¼‰
"Ref($close, 5) / $close - 1"

# 3. å¸ƒæž—é€šé“ä¸Šè»Œ
"Mean($close, 20) + 2 * Std($close, 20)"

# 4. Z-Score æ¨™æº–åŒ–
"($close - Mean($close, 20)) / Std($close, 20)"

# 5. MACD å¿«ç·š
"EMA($close, 12) - EMA($close, 26)"

# 6. RSI è¿‘ä¼¼å€¼ï¼ˆéœ€è¦è‡ªå®šç¾©å…¬å¼ï¼‰
"Sum(Greater($close - Ref($close, 1), 0), 14) / Sum(Abs($close - Ref($close, 1)), 14)"

# 7. æˆäº¤é‡åŠ æ¬Šå¹³å‡åƒ¹æ ¼ï¼ˆVWAPè¿‘ä¼¼ï¼‰
"Sum($close * $volume, 20) / Sum($volume, 20)"

# 8. åƒ¹æ ¼ç›¸å°ä½ç½®ï¼ˆ0-1ä¹‹é–“ï¼‰
"($close - Min($low, 20)) / (Max($high, 20) - Min($low, 20))"
```

---

## åŸºæœ¬é¢è²¡å‹™æ•¸æ“š

### ðŸ“Š 18 å€‹è²¡å‹™æŒ‡æ¨™è©³ç´°èªªæ˜Ž

**è³‡æ–™è¡¨**: `fundamental_data`
**æ¬„ä½çµæ§‹**: `stock_id`, `indicator`, `date`, `value`
**æ—¥æœŸæ ¼å¼**: "2024-Q1", "2024-Q2", "2024-Q3", "2024-Q4"

---

### æŒ‡æ¨™åˆ†é¡ž

#### 1. ç²åˆ©èƒ½åŠ›æŒ‡æ¨™ï¼ˆ5 å€‹ï¼‰

| æŒ‡æ¨™åç¨± | è‹±æ–‡åç¨± | è¨ˆç®—å…¬å¼ | èªªæ˜Ž |
|---------|---------|---------|------|
| **ROEç¨…å¾Œ** | Return on Equity | ç¨…å¾Œæ·¨åˆ© / è‚¡æ±æ¬Šç›Š | è‚¡æ±æŠ•è³‡å ±é…¬çŽ‡ |
| **ROAç¨…å¾Œæ¯å‰** | Return on Assets | (ç¨…å¾Œæ·¨åˆ©+åˆ©æ¯è²»ç”¨) / ç¸½è³‡ç”¢ | è³‡ç”¢ä½¿ç”¨æ•ˆçŽ‡ |
| **ç‡Ÿæ¥­æ¯›åˆ©çŽ‡** | Gross Profit Margin | ç‡Ÿæ¥­æ¯›åˆ© / ç‡Ÿæ”¶ | ç”¢å“ç«¶çˆ­åŠ› |
| **ç‡Ÿæ¥­åˆ©ç›ŠçŽ‡** | Operating Profit Margin | ç‡Ÿæ¥­åˆ©ç›Š / ç‡Ÿæ”¶ | æœ¬æ¥­ç²åˆ©èƒ½åŠ› |
| **ç¨…å¾Œæ·¨åˆ©çŽ‡** | Net Profit Margin | ç¨…å¾Œæ·¨åˆ© / ç‡Ÿæ”¶ | æ•´é«”ç²åˆ©èƒ½åŠ› |

#### 2. æˆé•·æ€§æŒ‡æ¨™ï¼ˆ3 å€‹ï¼‰

| æŒ‡æ¨™åç¨± | è¨ˆç®—å…¬å¼ | èªªæ˜Ž |
|---------|---------|------|
| **ç‡Ÿæ”¶æˆé•·çŽ‡** | (æœ¬æœŸç‡Ÿæ”¶ - åŽ»å¹´åŒæœŸç‡Ÿæ”¶) / åŽ»å¹´åŒæœŸç‡Ÿæ”¶ | ç‡Ÿæ”¶æˆé•·å‹•èƒ½ |
| **ç¨…å‰æ·¨åˆ©æˆé•·çŽ‡** | (æœ¬æœŸç¨…å‰æ·¨åˆ© - åŽ»å¹´åŒæœŸ) / åŽ»å¹´åŒæœŸ | ç²åˆ©æˆé•·å‹•èƒ½ |
| **ç¨…å¾Œæ·¨åˆ©æˆé•·çŽ‡** | (æœ¬æœŸç¨…å¾Œæ·¨åˆ© - åŽ»å¹´åŒæœŸ) / åŽ»å¹´åŒæœŸ | æ·¨åˆ©æˆé•·å‹•èƒ½ |

#### 3. æ¯è‚¡æŒ‡æ¨™ï¼ˆ3 å€‹ï¼‰

| æŒ‡æ¨™åç¨± | è¨ˆç®—å…¬å¼ | èªªæ˜Ž |
|---------|---------|------|
| **æ¯è‚¡ç¨…å¾Œæ·¨åˆ©** | ç¨…å¾Œæ·¨åˆ© / æµé€šåœ¨å¤–è‚¡æ•¸ | EPSï¼Œæœ€é‡è¦çš„æ¯è‚¡æŒ‡æ¨™ |
| **æ¯è‚¡ç‡Ÿæ¥­é¡** | ç‡Ÿæ¥­æ”¶å…¥ / æµé€šåœ¨å¤–è‚¡æ•¸ | æ¯è‚¡ç”¢ç”Ÿçš„ç‡Ÿæ”¶ |
| **æ¯è‚¡ç¾é‡‘æµé‡** | ç‡Ÿé‹ç¾é‡‘æµé‡ / æµé€šåœ¨å¤–è‚¡æ•¸ | æ¯è‚¡ç¾é‡‘ç”¢ç”Ÿèƒ½åŠ› |

#### 4. è²¡å‹™çµæ§‹æŒ‡æ¨™ï¼ˆ3 å€‹ï¼‰

| æŒ‡æ¨™åç¨± | è¨ˆç®—å…¬å¼ | èªªæ˜Ž |
|---------|---------|------|
| **è² å‚µæ¯”çŽ‡** | ç¸½è² å‚µ / ç¸½è³‡ç”¢ | è²¡å‹™æ§“æ¡¿ç¨‹åº¦ |
| **æµå‹•æ¯”çŽ‡** | æµå‹•è³‡ç”¢ / æµå‹•è² å‚µ | çŸ­æœŸå„Ÿå‚µèƒ½åŠ› |
| **é€Ÿå‹•æ¯”çŽ‡** | (æµå‹•è³‡ç”¢ - å­˜è²¨) / æµå‹•è² å‚µ | å³æ™‚å„Ÿå‚µèƒ½åŠ› |

#### 5. ç‡Ÿé‹æ•ˆçŽ‡æŒ‡æ¨™ï¼ˆ4 å€‹ï¼‰

| æŒ‡æ¨™åç¨± | è¨ˆç®—å…¬å¼ | èªªæ˜Ž |
|---------|---------|------|
| **ç¸½è³‡ç”¢é€±è½‰æ¬¡æ•¸** | ç‡Ÿæ”¶ / ç¸½è³‡ç”¢ | è³‡ç”¢ä½¿ç”¨æ•ˆçŽ‡ |
| **æ‡‰æ”¶å¸³æ¬¾é€±è½‰çŽ‡** | ç‡Ÿæ”¶ / å¹³å‡æ‡‰æ”¶å¸³æ¬¾ | æ‡‰æ”¶å¸³æ¬¾å›žæ”¶æ•ˆçŽ‡ |
| **å­˜è²¨é€±è½‰çŽ‡** | ç‡Ÿæ¥­æˆæœ¬ / å¹³å‡å­˜è²¨ | å­˜è²¨ç®¡ç†æ•ˆçŽ‡ |
| **ç¨…å‰æ·¨åˆ©çŽ‡** | ç¨…å‰æ·¨åˆ© / ç‡Ÿæ”¶ | ç¨…å‰ç²åˆ©èƒ½åŠ› |

---

### ðŸ“ ä½¿ç”¨ç¯„ä¾‹

#### SQL æŸ¥è©¢

```sql
-- 1. æŸ¥è©¢ç‰¹å®šè‚¡ç¥¨çš„æ‰€æœ‰è²¡å‹™æŒ‡æ¨™ï¼ˆæœ€æ–°å­£åº¦ï¼‰
SELECT indicator, value
FROM fundamental_data
WHERE stock_id = '2330'
  AND date = '2024-Q4'
ORDER BY indicator;

-- 2. æŸ¥è©¢ ROE å‰ 10 åè‚¡ç¥¨ï¼ˆ2024-Q4ï¼‰
SELECT stock_id, value as roe
FROM fundamental_data
WHERE indicator = 'ROEç¨…å¾Œ'
  AND date = '2024-Q4'
ORDER BY value DESC
LIMIT 10;

-- 3. æŸ¥è©¢ç‰¹å®šè‚¡ç¥¨çš„ ROE æ­·å²è¶¨å‹¢
SELECT date, value as roe
FROM fundamental_data
WHERE stock_id = '2330'
  AND indicator = 'ROEç¨…å¾Œ'
ORDER BY date;

-- 4. å¤šæŒ‡æ¨™ç¯©é¸ï¼ˆROE>15% ä¸” è² å‚µæ¯”çŽ‡<50%ï¼‰
SELECT DISTINCT fd1.stock_id
FROM fundamental_data fd1
JOIN fundamental_data fd2 ON fd1.stock_id = fd2.stock_id AND fd1.date = fd2.date
WHERE fd1.indicator = 'ROEç¨…å¾Œ' AND fd1.value > 15
  AND fd2.indicator = 'è² å‚µæ¯”çŽ‡' AND fd2.value < 50
  AND fd1.date = '2024-Q4';
```

#### Python æŸ¥è©¢

```python
from sqlalchemy import select
from app.models.stock import FundamentalData

# æŸ¥è©¢ç‰¹å®šè‚¡ç¥¨çš„ ROE
stmt = select(FundamentalData).where(
    FundamentalData.stock_id == '2330',
    FundamentalData.indicator == 'ROEç¨…å¾Œ',
    FundamentalData.date == '2024-Q4'
)
result = session.execute(stmt).scalar_one()
print(f"å°ç©é›» ROE: {result.value}%")
```

---

## ç”¢æ¥­èšåˆæŒ‡æ¨™

### ðŸ“Š 7 å€‹ç”¢æ¥­å¹³å‡æŒ‡æ¨™

**è³‡æ–™è¡¨**: `industry_metrics_cache`
**è³‡æ–™ä¾†æº**: å¾ž `fundamental_data` èšåˆè¨ˆç®—
**å¿«å–æœŸé™**: 30 å¤©

| æŒ‡æ¨™åç¨± | è‹±æ–‡åç¨± | è¨ˆç®—æ–¹å¼ | èªªæ˜Ž |
|---------|---------|---------|------|
| **avg_ROEç¨…å¾Œ** | Avg Return on Equity | ç”¢æ¥­å…§æ‰€æœ‰è‚¡ç¥¨ ROE å¹³å‡å€¼ | ç”¢æ¥­å¹³å‡è‚¡æ±æ¬Šç›Šå ±é…¬çŽ‡ |
| **avg_ROAç¨…å¾Œæ¯å‰** | Avg Return on Assets | ç”¢æ¥­å…§æ‰€æœ‰è‚¡ç¥¨ ROA å¹³å‡å€¼ | ç”¢æ¥­å¹³å‡è³‡ç”¢å ±é…¬çŽ‡ |
| **avg_ç‡Ÿæ¥­æ¯›åˆ©çŽ‡** | Avg Gross Profit Margin | ç”¢æ¥­å…§æ‰€æœ‰è‚¡ç¥¨æ¯›åˆ©çŽ‡å¹³å‡å€¼ | ç”¢æ¥­å¹³å‡æ¯›åˆ©çŽ‡ |
| **avg_ç‡Ÿæ¥­åˆ©ç›ŠçŽ‡** | Avg Operating Profit Margin | ç”¢æ¥­å…§æ‰€æœ‰è‚¡ç¥¨ç‡Ÿæ¥­åˆ©ç›ŠçŽ‡å¹³å‡å€¼ | ç”¢æ¥­å¹³å‡ç‡Ÿæ¥­åˆ©ç›ŠçŽ‡ |
| **avg_æ¯è‚¡ç¨…å¾Œæ·¨åˆ©** | Avg EPS | ç”¢æ¥­å…§æ‰€æœ‰è‚¡ç¥¨ EPS å¹³å‡å€¼ | ç”¢æ¥­å¹³å‡æ¯è‚¡ç›ˆåˆ© |
| **avg_ç‡Ÿæ”¶æˆé•·çŽ‡** | Avg Revenue Growth | ç”¢æ¥­å…§æ‰€æœ‰è‚¡ç¥¨ç‡Ÿæ”¶æˆé•·çŽ‡å¹³å‡å€¼ | ç”¢æ¥­å¹³å‡ç‡Ÿæ”¶æˆé•·çŽ‡ |
| **avg_ç¨…å¾Œæ·¨åˆ©æˆé•·çŽ‡** | Avg Net Profit Growth | ç”¢æ¥­å…§æ‰€æœ‰è‚¡ç¥¨æ·¨åˆ©æˆé•·çŽ‡å¹³å‡å€¼ | ç”¢æ¥­å¹³å‡æ·¨åˆ©æˆé•·çŽ‡ |

---

### ðŸ­ ç”¢æ¥­åˆ†é¡žè³‡è¨Š

#### TWSE 3 å±¤éšŽå±¤åˆ†é¡ž

**è³‡æ–™è¡¨**: `industries`, `stock_industries`

```yaml
ç”¢æ¥­ç¸½æ•¸: 41 å€‹
è‚¡ç¥¨æ˜ å°„: 1,935 ç­†
åˆ†é¡žå±¤ç´š:
  - å¤§é¡ž: æ°´æ³¥å·¥æ¥­ã€é£Ÿå“å·¥æ¥­ã€å¡‘è† å·¥æ¥­ç­‰
  - ä¸­é¡ž: é£Ÿå“åŠ å·¥ã€é£²æ–™ã€ç´¡ç¹”çº–ç¶­ç­‰
  - å°é¡ž: ç´°åˆ†è¡Œæ¥­

ä¸»è¦ç”¢æ¥­ç¯„ä¾‹:
  - åŠå°Žé«”æ¥­
  - é›»è…¦åŠé€±é‚Šè¨­å‚™æ¥­
  - å…‰é›»æ¥­
  - é€šä¿¡ç¶²è·¯æ¥­
  - é›»å­é›¶çµ„ä»¶æ¥­
  - é‡‘èžä¿éšªæ¥­
  - é‹¼éµå·¥æ¥­
  - æ±½è»Šå·¥æ¥­
  ... (å…± 41 å€‹)
```

#### æŸ¥è©¢ç¯„ä¾‹

```sql
-- 1. æŸ¥è©¢ç‰¹å®šç”¢æ¥­çš„æ‰€æœ‰è‚¡ç¥¨
SELECT si.stock_id, i.industry_name
FROM stock_industries si
JOIN industries i ON si.industry_code = i.industry_code
WHERE i.industry_name = 'åŠå°Žé«”æ¥­';

-- 2. æŸ¥è©¢ç”¢æ¥­æŒ‡æ¨™å¿«å–
SELECT industry_code, date, metric_name, metric_value
FROM industry_metrics_cache
WHERE industry_code = 'M2300'  -- åŠå°Žé«”æ¥­
  AND date = '2024-Q4'
ORDER BY metric_name;

-- 3. æŸ¥è©¢ç‰¹å®šè‚¡ç¥¨æ‰€å±¬ç”¢æ¥­
SELECT i.*
FROM industries i
JOIN stock_industries si ON i.industry_code = si.industry_code
WHERE si.stock_id = '2330';
```

---

## å›žæ¸¬ç¸¾æ•ˆæŒ‡æ¨™

### ðŸ“ˆ å›žæ¸¬çµæžœè©•ä¼°æŒ‡æ¨™ï¼ˆ20+ å€‹ï¼‰

**è³‡æ–™è¡¨**: `backtest_results`
**é—œè¯**: é—œè¯åˆ° `backtests` è¡¨

---

### æŒ‡æ¨™åˆ†é¡ž

#### 1. æ”¶ç›ŠæŒ‡æ¨™ï¼ˆ4 å€‹ï¼‰

| æŒ‡æ¨™åç¨± | è‹±æ–‡åç¨± | è¨ˆç®—å…¬å¼ | èªªæ˜Ž |
|---------|---------|---------|------|
| **annual_return** | Annual Return | (æœŸæœ«æ·¨å€¼ / æœŸåˆæ·¨å€¼)^(365/å¤©æ•¸) - 1 | å¹´åŒ–å ±é…¬çŽ‡ |
| **total_return** | Total Return | (æœŸæœ«æ·¨å€¼ - æœŸåˆæ·¨å€¼) / æœŸåˆæ·¨å€¼ | ç¸½å ±é…¬çŽ‡ |
| **monthly_return** | Monthly Return | annual_return / 12 | æœˆå‡å ±é…¬çŽ‡ |
| **daily_return** | Daily Return | total_return / äº¤æ˜“å¤©æ•¸ | æ—¥å‡å ±é…¬çŽ‡ |

#### 2. é¢¨éšªæŒ‡æ¨™ï¼ˆ7 å€‹ï¼‰

| æŒ‡æ¨™åç¨± | è‹±æ–‡åç¨± | è¨ˆç®—å…¬å¼ | èªªæ˜Ž |
|---------|---------|---------|------|
| **sharpe_ratio** | Sharpe Ratio | (å¹´åŒ–å ±é…¬ - ç„¡é¢¨éšªåˆ©çŽ‡) / å¹´åŒ–æ³¢å‹•çŽ‡ | å¤æ™®æ¯”çŽ‡ï¼ˆé¢¨éšªèª¿æ•´å¾Œå ±é…¬ï¼‰ |
| **max_drawdown** | Maximum Drawdown | æœ€å¤§å›žæ’¤ç™¾åˆ†æ¯” | å¾žé«˜é»žåˆ°ä½Žé»žçš„æœ€å¤§è·Œå¹… |
| **volatility** | Volatility | æ—¥å ±é…¬çŽ‡æ¨™æº–å·® Ã— âˆš252 | å¹´åŒ–æ³¢å‹•çŽ‡ |
| **downside_deviation** | Downside Deviation | è² å ±é…¬çš„æ¨™æº–å·® | ä¸‹è¡Œæ¨™æº–å·® |
| **calmar_ratio** | Calmar Ratio | å¹´åŒ–å ±é…¬ / æœ€å¤§å›žæ’¤ | Calmar æ¯”çŽ‡ |
| **sortino_ratio** | Sortino Ratio | (å¹´åŒ–å ±é…¬ - ç„¡é¢¨éšªåˆ©çŽ‡) / ä¸‹è¡Œæ¨™æº–å·® | Sortino æ¯”çŽ‡ |
| **var_95** | Value at Risk (95%) | 95% ä¿¡è³´å€é–“çš„æœ€å¤§æå¤± | 95% VaR |

#### 3. äº¤æ˜“æŒ‡æ¨™ï¼ˆ7 å€‹ï¼‰

| æŒ‡æ¨™åç¨± | è‹±æ–‡åç¨± | èªªæ˜Ž |
|---------|---------|------|
| **total_trades** | Total Trades | ç¸½äº¤æ˜“æ¬¡æ•¸ |
| **win_rate** | Win Rate | ç²åˆ©äº¤æ˜“æ¬¡æ•¸ / ç¸½äº¤æ˜“æ¬¡æ•¸ |
| **avg_win** | Average Win | å¹³å‡æ¯æ¬¡ç²åˆ©é‡‘é¡ |
| **avg_loss** | Average Loss | å¹³å‡æ¯æ¬¡è™§æé‡‘é¡ |
| **avg_holding_days** | Avg Holding Days | å¹³å‡æŒå€‰å¤©æ•¸ |
| **max_consecutive_wins** | Max Consecutive Wins | æœ€å¤§é€£çºŒç²åˆ©æ¬¡æ•¸ |
| **max_consecutive_losses** | Max Consecutive Losses | æœ€å¤§é€£çºŒè™§ææ¬¡æ•¸ |

#### 4. ç¶œåˆè©•ä¼°æŒ‡æ¨™ï¼ˆ5 å€‹ï¼‰

| æŒ‡æ¨™åç¨± | è‹±æ–‡åç¨± | è¨ˆç®—å…¬å¼ | èªªæ˜Ž |
|---------|---------|---------|------|
| **win_loss_ratio** | Win/Loss Ratio | avg_win / avg_loss | ç›ˆè™§æ¯” |
| **profit_factor** | Profit Factor | ç¸½ç²åˆ© / ç¸½è™§æ | ç²åˆ©å› å­ |
| **recovery_factor** | Recovery Factor | æ·¨åˆ© / æœ€å¤§å›žæ’¤ | æ¢å¾©ä¿‚æ•¸ |
| **expectancy** | Expectancy | (å‹çŽ‡ Ã— å¹³å‡ç²åˆ©) - (æ•—çŽ‡ Ã— å¹³å‡è™§æ) | æœŸæœ›å€¼ |
| **risk_level** | Risk Level | æ ¹æ“š Sharpeã€æ³¢å‹•çŽ‡ã€å›žæ’¤ç¶œåˆè©•ä¼° | é¢¨éšªç­‰ç´šï¼ˆä½Ž/ä¸­/é«˜ï¼‰ |

---

### ðŸ“ ä½¿ç”¨ç¯„ä¾‹

#### SQL æŸ¥è©¢

```sql
-- 1. æŸ¥è©¢å›žæ¸¬çµæžœ
SELECT
    backtest_id,
    annual_return,
    sharpe_ratio,
    max_drawdown,
    win_rate,
    total_trades
FROM backtest_results
WHERE backtest_id = 123;

-- 2. æ‰¾å‡ºè¡¨ç¾æœ€å¥½çš„ç­–ç•¥ï¼ˆä¾ Sharpe Ratioï¼‰
SELECT
    b.strategy_id,
    s.name as strategy_name,
    br.sharpe_ratio,
    br.annual_return,
    br.max_drawdown
FROM backtest_results br
JOIN backtests b ON br.backtest_id = b.id
JOIN strategies s ON b.strategy_id = s.id
ORDER BY br.sharpe_ratio DESC
LIMIT 10;

-- 3. æŸ¥è©¢ç‰¹å®šç­–ç•¥çš„æ‰€æœ‰å›žæ¸¬çµæžœ
SELECT
    b.id as backtest_id,
    b.start_date,
    b.end_date,
    br.annual_return,
    br.sharpe_ratio,
    br.max_drawdown
FROM backtests b
JOIN backtest_results br ON b.id = br.backtest_id
WHERE b.strategy_id = 456
ORDER BY b.created_at DESC;
```

---

## é™„éŒ„

### ðŸ“ é—œéµæ–‡ä»¶ä½ç½®

| å…§å®¹ | æª”æ¡ˆè·¯å¾‘ |
|------|---------|
| **Backtrader ç¯„æœ¬** | `/home/ubuntu/QuantLab/frontend/components/StrategyTemplates.vue` |
| **Qlib ç¯„æœ¬** | `/home/ubuntu/QuantLab/frontend/components/QlibStrategyTemplates.vue` |
| **å› å­ç¯„æœ¬** | `/home/ubuntu/QuantLab/frontend/components/FactorStrategyTemplates.vue` |
| **Alpha158 è¨ˆç®—å™¨** | `/home/ubuntu/QuantLab/backend/app/services/alpha158_factors.py` |
| **Qlib é…ç½®** | `/home/ubuntu/QuantLab/backend/app/core/qlib_config.py` |
| **Qlib å›žæ¸¬å¼•æ“Ž** | `/home/ubuntu/QuantLab/backend/app/services/qlib_backtest_engine.py` |
| **RD-Agent æ¨¡åž‹** | `/home/ubuntu/QuantLab/backend/app/models/rdagent.py` |
| **ç”¢æ¥­æœå‹™** | `/home/ubuntu/QuantLab/backend/app/services/industry_service.py` |
| **è³‡æ–™åº«æ¨¡åž‹** | `/home/ubuntu/QuantLab/backend/app/models/` |

---

### ðŸ”— ç›¸é—œæ–‡æª”

- **[README.md](../README.md)** - å¿«é€Ÿå•Ÿå‹•æŒ‡å—
- **[CLAUDE.md](../CLAUDE.md)** - å°ˆæ¡ˆæž¶æ§‹èªªæ˜Ž
- **[docs/QLIB.md](QLIB.md)** - Qlib å¼•æ“Žå®Œæ•´æŒ‡å—
- **[docs/RDAGENT.md](RDAGENT.md)** - RD-Agent å®Œæ•´æŒ‡å—
- **[Document/DATABASE_SCHEMA_REPORT.md](../Document/DATABASE_SCHEMA_REPORT.md)** - è³‡æ–™åº«æž¶æ§‹å ±å‘Š

---

### ðŸ“Š æ•¸æ“šåŒæ­¥å¿«å–ç­–ç•¥

| æ•¸æ“šæº | å¿«å–æ™‚é–“ | æ›´æ–°é »çŽ‡ | ä»»å‹™åç¨± |
|--------|---------|---------|---------|
| è‚¡ç¥¨æ¸…å–® | 24å°æ™‚ | æ¯å¤© 8:00 AM | `sync_stock_list` |
| æ¯æ—¥åƒ¹æ ¼ | 10åˆ†é˜ | æ¯å¤© 9:00 PM | `sync_daily_prices` |
| OHLCVæ•¸æ“š | 10åˆ†é˜ | æ¯å¤© 10:00 PM | `sync_ohlcv_data` |
| æœ€æ–°åƒ¹æ ¼ | 5åˆ†é˜ | äº¤æ˜“æ™‚æ®µæ¯15åˆ†é˜ | `sync_latest_prices` |
| QlibäºŒé€²åˆ¶æ•¸æ“š | è‡ªå‹• | æŒ‰éœ€åŒæ­¥ | Smart Sync |
| ç”¢æ¥­æŒ‡æ¨™ | 30å¤© | æŒ‰éœ€æ›´æ–° | éœæ…‹å¿«å– |

---

## ç¸½çµ

**QuantLab å› å­åº«ç‰¹è‰²**:

1. âœ… **è±å¯Œçš„åŽŸå§‹æ•¸æ“š**: 2,671 æª”è‚¡ç¥¨ Ã— 7 å¹´æ­·å² + 18 å€‹è²¡å‹™æŒ‡æ¨™
2. âš™ï¸ **å¼·å¤§çš„è¨ˆç®—å¼•æ“Ž**: Alpha158ï¼ˆ179å€‹å› å­ï¼‰+ Qlib è¡¨é”å¼
3. ðŸ¤– **AI è‡ªå‹•æŒ–æŽ˜**: RD-Agent è‡ªå‹•ç”Ÿæˆå’Œå„ªåŒ–å› å­
4. ðŸ“Š **é›™å¼•æ“Žæ”¯æ´**: Backtraderï¼ˆæŠ€è¡“åˆ†æžï¼‰+ Qlibï¼ˆæ©Ÿå™¨å­¸ç¿’ï¼‰
5. ðŸš€ **é«˜æ•ˆèƒ½è¨­è¨ˆ**: Qlib äºŒé€²åˆ¶æ ¼å¼è®€å–å¿« 3-10 å€

**ç°¡å–®èªª**: ä½ æœ‰**å®Œæ•´çš„åŽŸå§‹æ•¸æ“š**å’Œ**å¼·å¤§çš„è¨ˆç®—å·¥å…·**ï¼Œå¯ä»¥å¯¦ç¾ä»»ä½•é‡åŒ–ç­–ç•¥ï¼

---

**æ–‡æª”ç‰ˆæœ¬**: v1.0
**æœ€å¾Œæ›´æ–°**: 2025-12-13
**ç¶­è­·è€…**: QuantLab Team
