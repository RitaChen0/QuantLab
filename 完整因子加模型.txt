 å®Œæ•´å·¥ä½œæµç¨‹ï¼šå› å­ + æ¨¡å‹æ•´åˆ

  è®“æˆ‘è©³ç´°èªªæ˜å¦‚ä½•å°‡ RD-Agent ç”Ÿæˆçš„å› å­ä½œç‚ºæ©Ÿå™¨å­¸ç¿’æ¨¡å‹çš„è¼¸å…¥ç‰¹å¾µã€‚

  ---
  ğŸ“‹ äº”æ­¥é©Ÿå®Œæ•´æµç¨‹

  ç¬¬ä¸€æ­¥ï¼šå› å­æŒ–æ˜ï¼ˆç”Ÿæˆç‰¹å¾µï¼‰

  1.1 å‰å¾€ RD-Agent é é¢

  URL: http://122.116.152.55/rdagent
  Tab: é»æ“Šã€Œå› å­æŒ–æ˜ã€

  1.2 å¡«å¯«ç ”ç©¶ç›®æ¨™

  ç ”ç©¶ç›®æ¨™:
  ç‚ºå°è‚¡å‰µå»ºå¤šå€‹é æ¸¬å› å­ï¼ŒåŒ…æ‹¬ï¼š
  1. çŸ­æœŸå‹•é‡å› å­ï¼ˆ1-5æ—¥ï¼‰
  2. ä¸­æœŸå‹•é‡å› å­ï¼ˆ10-20æ—¥ï¼‰
  3. æ³¢å‹•ç‡å› å­
  4. æˆäº¤é‡å› å­
  5. åƒ¹æ ¼åè½‰å› å­

  ç›®æ¨™æ˜¯ç‚ºæ©Ÿå™¨å­¸ç¿’æ¨¡å‹æä¾›å¤šæ¨£åŒ–çš„ç‰¹å¾µ

  1.3 è¨­å®šåƒæ•¸

  æœ€å¤šç”Ÿæˆå› å­æ•¸: 10
  LLM æ¨¡å‹: GPT-4 Turbo
  æœ€å¤§è¿­ä»£æ¬¡æ•¸: 5

  1.4 ç­‰å¾…ç”Ÿæˆï¼ˆç´„ 5-10 åˆ†é˜ï¼‰

  é æœŸè¼¸å‡ºï¼ˆ10 å€‹å› å­ç¯„ä¾‹ï¼‰ï¼š
  # å› å­ 1: çŸ­æœŸå‹•é‡
  '($close - Ref($close, 5)) / Ref($close, 5)'

  # å› å­ 2: ä¸­æœŸå‹•é‡  
  '($close - Ref($close, 20)) / Ref($close, 20)'

  # å› å­ 3: æ³¢å‹•ç‡
  'Std($close, 10)'

  # å› å­ 4: æˆäº¤é‡æ¯”ç‡
  '$volume / Mean($volume, 20)'

  # å› å­ 5: RSI é¡ä¼¼æŒ‡æ¨™
  '($close - Mean($close, 14)) / Std($close, 14)'

  # å› å­ 6: åƒ¹æ ¼ä½ç½®
  '($close - $low) / ($high - $low)'

  # å› å­ 7: å‡ç·šè·é›¢
  '$close / Mean($close, 20) - 1'

  # å› å­ 8: åƒ¹é‡ç›¸é—œæ€§
  'Corr($close, $volume, 10)'

  # å› å­ 9: é«˜ä½åƒ¹å·®
  '($high - $low) / $close'

  # å› å­ 10: æ”¶ç›¤é–‹ç›¤æ¯”
  '$close / $open - 1'

  ---
  ç¬¬äºŒæ­¥ï¼šæ¨¡å‹ç”Ÿæˆï¼ˆå‰µå»ºæ¨¡å‹æ¶æ§‹ï¼‰

  2.1 åˆ‡æ›åˆ°ã€Œç”Ÿæˆçš„æ¨¡å‹ã€Tab

  Tab: é»æ“Šã€Œç”Ÿæˆçš„æ¨¡å‹ã€

  2.2 å¡«å¯«æ¨¡å‹ç”Ÿæˆç›®æ¨™

  ç ”ç©¶ç›®æ¨™:
  å‰µå»º Transformer æ™‚é–“åºåˆ—é æ¸¬æ¨¡å‹ï¼Œç”¨æ–¼é æ¸¬å°è‚¡æœªä¾† 1 æ—¥å ±é…¬ç‡ã€‚
  æ¨¡å‹æ‡‰è©²ï¼š
  1. ä½¿ç”¨å¤šé ­æ³¨æ„åŠ›æ©Ÿåˆ¶æ•æ‰æ™‚åºä¾è³´
  2. æ”¯æ´å¤šå› å­è¼¸å…¥ï¼ˆ10-20 å€‹ç‰¹å¾µï¼‰
  3. åŒ…å«ä½ç½®ç·¨ç¢¼
  4. ä½¿ç”¨ early stopping é˜²æ­¢éæ“¬åˆ

  æ¨¡å‹é¡å‹åå¥½: æ™‚é–“åºåˆ—æ¨¡å‹ (GRU/LSTM/Transformer)
  LLM æ¨¡å‹: GPT-4 Turbo
  æœ€å¤§è¿­ä»£æ¬¡æ•¸: 3

  2.3 ç­‰å¾…ç”Ÿæˆï¼ˆç´„ 15-30 åˆ†é˜ï¼‰

  é æœŸè¼¸å‡ºï¼š
  - æ¨¡å‹åç¨±ï¼šTransformerPredictor
  - å®Œæ•´ PyTorch ä»£ç¢¼ï¼ˆ~6700 å­—ç¬¦ï¼‰
  - Qlib é…ç½®æª”

  ---
  ç¬¬ä¸‰æ­¥ï¼šæ•´åˆå› å­åˆ°æ¨¡å‹ï¼ˆé—œéµæ­¥é©Ÿï¼‰

â— 3.1 æ”¶é›†å› å­è¡¨é”å¼

  å¾ã€Œç”Ÿæˆçš„å› å­ã€åˆ—è¡¨ä¸­ï¼Œè¤‡è£½æ‰€æœ‰å› å­çš„ formula æ¬„ä½ï¼š

  # å¾ RD-Agent å› å­é é¢è¤‡è£½
  RDAGENT_FACTORS = [
      '($close - Ref($close, 5)) / Ref($close, 5)',
      '($close - Ref($close, 20)) / Ref($close, 20)',
      'Std($close, 10)',
      '$volume / Mean($volume, 20)',
      '($close - Mean($close, 14)) / Std($close, 14)',
      '($close - $low) / ($high - $low)',
      '$close / Mean($close, 20) - 1',
      'Corr($close, $volume, 10)',
      '($high - $low) / $close',
      '$close / $open - 1',
  ]

  3.2 ä¿®æ”¹æ¨¡å‹ä»£ç¢¼

  å¾ã€Œç”Ÿæˆçš„æ¨¡å‹ã€å¡ç‰‡ä¸­ï¼Œé»æ“Šã€ŒæŸ¥çœ‹ä»£ç¢¼ â–¼ã€ï¼Œè¤‡è£½æ•´å€‹æ¨¡å‹ä»£ç¢¼ï¼Œç„¶å¾Œé€²è¡Œä»¥ä¸‹ä¿®æ”¹ï¼š

â— Write(/tmp/transformer_with_rdagent_factors.py)
  â¿  Wrote 371 lines to ../../../tmp/transformer_with_rdagent_factors.py        
     """
     TransformerPredictor - æ•´åˆ RD-Agent å› å­
     é€™å€‹ç¯„ä¾‹å±•ç¤ºå¦‚ä½•å°‡ RD-Agent ç”Ÿæˆçš„ 10 å€‹å› å­ä½œç‚º Transformer æ¨¡å‹çš„è¼¸å…¥ç‰¹å¾µ
     """
     import torch
     import torch.nn as nn
     import torch.nn.functional as F
     import math
     â€¦ +361 lines (ctrl+o to expand)

â— ---
  ç¬¬å››æ­¥ï¼šè¨“ç·´æ¨¡å‹

  4.1 ä¿å­˜æ¨¡å‹ä»£ç¢¼

  å°‡ä¸Šé¢ç”Ÿæˆçš„ä»£ç¢¼ä¿å­˜åˆ°å¾Œç«¯ï¼š

  # åœ¨å¾Œç«¯å®¹å™¨ä¸­åŸ·è¡Œ
  docker compose exec backend bash

  # å‰µå»ºè‡ªè¨‚æ¨¡å‹ç›®éŒ„
  mkdir -p /app/custom_models

  # ä¿å­˜æ¨¡å‹æ–‡ä»¶
  cat > /app/custom_models/transformer_with_rdagent_factors.py << 'EOF'
  # ï¼ˆè²¼ä¸Šä¸Šé¢çš„å®Œæ•´ä»£ç¢¼ï¼‰
  EOF

  æˆ–è€…ç›´æ¥è¤‡è£½åˆ°ä¸»æ©Ÿï¼š

  # å¾ä¸»æ©Ÿè¤‡è£½
  cp /tmp/transformer_with_rdagent_factors.py /home/ubuntu/QuantLab/backend/custom_models/

  4.2 å‰µå»ºè¨“ç·´è…³æœ¬

â— Write(/tmp/train_transformer_with_factors.py)
  â¿  Wrote 263 lines to ../../../tmp/train_transformer_with_factors.py                    
     """
     è¨“ç·´ Transformer æ¨¡å‹ - ä½¿ç”¨ RD-Agent å› å­
     åŸ·è¡Œæ–¹å¼:
         docker compose exec backend python /app/scripts/train_transformer_with_factors.py
     """
     import sys
     sys.path.insert(0, '/app')
     â€¦ +253 lines (ctrl+o to expand)

â— 4.3 åŸ·è¡Œè¨“ç·´

  # è¤‡è£½è¨“ç·´è…³æœ¬åˆ°å¾Œç«¯
  docker compose cp /tmp/train_transformer_with_factors.py backend:/app/scripts/

  # åŸ·è¡Œè¨“ç·´ï¼ˆç´„ 1-2 å°æ™‚ï¼‰
  docker compose exec backend python /app/scripts/train_transformer_with_factors.py

  é æœŸè¼¸å‡ºï¼š
  ======================================================================
  é–‹å§‹è¨“ç·´ Transformer æ¨¡å‹ - ä½¿ç”¨ RD-Agent å› å­
  ======================================================================
  âœ… Qlib åˆå§‹åŒ–æˆåŠŸ
  âœ… è¼‰å…¥è‡ªè¨‚æ¨¡å‹ï¼Œä½¿ç”¨ 10 å€‹ RD-Agent å› å­
  ğŸ“Š æº–å‚™è¨“ç·´æ•¸æ“š...
  è¨“ç·´é›†: 45234 æ¨£æœ¬
  é©—è­‰é›†: 12056 æ¨£æœ¬
  æ¸¬è©¦é›†: 8901 æ¨£æœ¬
  X_train shape: (43214, 20, 10)
  y_train shape: (43214,)
  ä½¿ç”¨è¨­å‚™: cuda
  æ¨¡å‹åƒæ•¸æ•¸é‡: 1,234,567
  ğŸš€ é–‹å§‹è¨“ç·´æ¨¡å‹ (device: cuda)
  Epoch [  1/100] Train Loss: 0.003421, Valid Loss: 0.002987
  ğŸ’¾ ä¿å­˜æœ€ä½³æ¨¡å‹ (valid_loss: 0.002987)
  Epoch [  2/100] Train Loss: 0.002654, Valid Loss: 0.002543
  ğŸ’¾ ä¿å­˜æœ€ä½³æ¨¡å‹ (valid_loss: 0.002543)
  ...
  Epoch [ 45/100] Train Loss: 0.001234, Valid Loss: 0.001198
  ğŸ’¾ ä¿å­˜æœ€ä½³æ¨¡å‹ (valid_loss: 0.001198)
  â¹ï¸ Early stopping at epoch 55
  âœ… è¨“ç·´å®Œæˆï¼æœ€ä½³é©—è­‰æå¤±: 0.001198
  ğŸ“ˆ è©•ä¼°æ¨¡å‹...
  æ¸¬è©¦é›†æå¤±: 0.001256
  é æ¸¬ç›¸é—œæ€§ (IC): 0.0847
  ======================================================================
  ğŸ‰ è¨“ç·´å®Œæˆï¼
  æ¨¡å‹å·²ä¿å­˜è‡³: /app/models/best_transformer_rdagent.pth
  æ¸¬è©¦é›† IC: 0.0847
  ======================================================================

  ---
  ç¬¬äº”æ­¥ï¼šåœ¨ç­–ç•¥ä¸­ä½¿ç”¨è¨“ç·´å¥½çš„æ¨¡å‹

â— Write(/tmp/qlib_strategy_with_trained_model.py)
  â¿  Wrote 197 lines to ../../../tmp/qlib_strategy_with_trained_model.py
     """
     Qlib ç­–ç•¥ - ä½¿ç”¨è¨“ç·´å¥½çš„ Transformer æ¨¡å‹
     é€™å€‹ç­–ç•¥å±•ç¤ºå¦‚ä½•åœ¨å¯¦éš›äº¤æ˜“ä¸­ä½¿ç”¨è¨“ç·´å¥½çš„æ¨¡å‹é€²è¡Œé æ¸¬
     """
     import sys
     sys.path.insert(0, '/app')
     import qlib
     â€¦ +187 lines (ctrl+o to expand)

â— ---
  ğŸ“Š å®Œæ•´å·¥ä½œæµç¨‹ç¸½çµ

  ğŸ”„ æ•´é«”æµç¨‹åœ–

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                  æ­¥é©Ÿ 1: å› å­æŒ–æ˜                            â”‚
  â”‚  RD-Agent ç”Ÿæˆ 10 å€‹ Qlib è¡¨é”å¼å› å­                         â”‚
  â”‚                                                             â”‚
  â”‚  è¼¸å…¥: ç ”ç©¶ç›®æ¨™                                              â”‚
  â”‚  è¼¸å‡º: 10 å€‹ Qlib è¡¨é”å¼                                     â”‚
  â”‚    - ($close - Ref($close, 5)) / Ref($close, 5)           â”‚
  â”‚    - Std($close, 10)                                       â”‚
  â”‚    - ... (å…± 10 å€‹)                                         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                  æ­¥é©Ÿ 2: æ¨¡å‹ç”Ÿæˆ                            â”‚
  â”‚  RD-Agent ç”Ÿæˆ Transformer æ¨¡å‹ä»£ç¢¼                          â”‚
  â”‚                                                             â”‚
  â”‚  è¼¸å…¥: æ¨¡å‹éœ€æ±‚                                              â”‚
  â”‚  è¼¸å‡º: PyTorch æ¨¡å‹é¡ + Qlib é…ç½®                            â”‚
  â”‚    - TransformerPredictor (6700+ è¡Œ)                       â”‚
  â”‚    - PositionalEncoding                                     â”‚
  â”‚    - è¨“ç·´å‡½æ•¸                                                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                  æ­¥é©Ÿ 3: æ•´åˆ                                â”‚
  â”‚  å°‡å› å­è¡¨é”å¼ä½œç‚ºæ¨¡å‹è¼¸å…¥ç‰¹å¾µ                                 â”‚
  â”‚                                                             â”‚
  â”‚  æ“ä½œ:                                                      â”‚
  â”‚  1. ä¿®æ”¹ DataHandler çš„ fields åƒæ•¸                         â”‚
  â”‚  2. è¨­å®š d_feat=10 (å› å­æ•¸é‡)                               â”‚
  â”‚  3. ä½¿ç”¨ D.features() è¨ˆç®—å› å­å€¼                            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                  æ­¥é©Ÿ 4: è¨“ç·´                                â”‚
  â”‚  è¨“ç·´ Transformer æ¨¡å‹ (1-2 å°æ™‚)                            â”‚
  â”‚                                                             â”‚
  â”‚  éç¨‹:                                                      â”‚
  â”‚  - Epoch 1-100, early stopping                             â”‚
  â”‚  - è¨“ç·´é›†: 43214 æ¨£æœ¬                                        â”‚
  â”‚  - é©—è­‰é›†: 12056 æ¨£æœ¬                                        â”‚
  â”‚  - æœ€ä½³æ¨¡å‹ä¿å­˜: best_transformer_rdagent.pth               â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                  æ­¥é©Ÿ 5: å›æ¸¬/å¯¦ç›¤                           â”‚
  â”‚  ä½¿ç”¨è¨“ç·´å¥½çš„æ¨¡å‹é æ¸¬å’Œäº¤æ˜“                                   â”‚
  â”‚                                                             â”‚
  â”‚  æ¯æ—¥æµç¨‹:                                                  â”‚
  â”‚  1. è®€å–è‚¡ç¥¨æ±  (å‰ 50 å¤§)                                    â”‚
  â”‚  2. è¨ˆç®—å„è‚¡ç¥¨çš„ 10 å€‹å› å­å€¼                                 â”‚
  â”‚  3. æ¨¡å‹é æ¸¬æœªä¾†æ”¶ç›Š                                         â”‚
  â”‚  4. é¸æ“‡ Top 5 è²·å…¥                                         â”‚
  â”‚  5. åŸ·è¡Œäº¤æ˜“                                                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---
  ğŸ› ï¸ å¯¦éš›æ“ä½œæ­¥é©Ÿï¼ˆè©³ç´°ç‰ˆï¼‰

  æº–å‚™å·¥ä½œ

  # 1. ç¢ºä¿ç’°å¢ƒæ­£å¸¸
  docker compose ps

  # 2. å‰µå»ºæ¨¡å‹ç›®éŒ„
  docker compose exec backend mkdir -p /app/custom_models
  docker compose exec backend mkdir -p /app/models
  docker compose exec backend mkdir -p /app/scripts

  åŸ·è¡Œæµç¨‹

  â‘  å› å­æŒ–æ˜ï¼ˆå‰ç«¯æ“ä½œï¼Œ10 åˆ†é˜ï¼‰

  1. è¨ªå• http://122.116.152.55/rdagent
  2. å¡«å¯«ç ”ç©¶ç›®æ¨™ï¼ˆè¦‹ä¸Šé¢ç¯„ä¾‹ï¼‰
  3. é»æ“Šã€ŒğŸš€ é–‹å§‹æŒ–æ˜ã€
  4. ç­‰å¾…å®Œæˆï¼ˆç´„ 5-10 åˆ†é˜ï¼‰
  5. è¨˜éŒ„æ‰€æœ‰å› å­çš„ formula

  â‘¡ æ¨¡å‹ç”Ÿæˆï¼ˆå‰ç«¯æ“ä½œï¼Œ30 åˆ†é˜ï¼‰

  1. åˆ‡æ›åˆ°ã€Œç”Ÿæˆçš„æ¨¡å‹ã€tab
  2. å¡«å¯«æ¨¡å‹éœ€æ±‚ï¼ˆè¦‹ä¸Šé¢ç¯„ä¾‹ï¼‰
  3. é»æ“Šã€ŒğŸš€ é–‹å§‹ç”Ÿæˆæ¨¡å‹ã€
  4. ç­‰å¾…å®Œæˆï¼ˆç´„ 15-30 åˆ†é˜ï¼‰
  5. é»æ“Šã€ŒæŸ¥çœ‹ä»£ç¢¼ã€ç²å–æ¨¡å‹ä»£ç¢¼

  â‘¢ æ•´åˆèˆ‡è¨“ç·´ï¼ˆå¾Œç«¯æ“ä½œï¼Œ2 å°æ™‚ï¼‰

  # 1. è¤‡è£½æ•´åˆä»£ç¢¼åˆ°å¾Œç«¯
  docker compose cp /tmp/transformer_with_rdagent_factors.py \
    backend:/app/custom_models/

  docker compose cp /tmp/train_transformer_with_factors.py \
    backend:/app/scripts/

  # 2. ä¿®æ”¹å› å­åˆ—è¡¨ï¼ˆä½¿ç”¨å¯¦éš›ç”Ÿæˆçš„å› å­ï¼‰
  docker compose exec backend nano /app/custom_models/transformer_with_rdagent_factors.py
  # ç·¨è¼¯ RDAGENT_FACTORS åˆ—è¡¨ï¼Œè²¼ä¸Šå¯¦éš›çš„å› å­è¡¨é”å¼

  # 3. åŸ·è¡Œè¨“ç·´
  docker compose exec backend python /app/scripts/train_transformer_with_factors.py

  # è¨“ç·´ç´„ 1-2 å°æ™‚ï¼ŒæœŸé–“å¯ä»¥ï¼š
  # - æŸ¥çœ‹æ—¥èªŒ
  # - ç›£æ§ GPU ä½¿ç”¨ç‡ï¼ˆå¦‚æœ‰ï¼‰
  # - å–æ¯å’–å•¡ â˜•

  â‘£ ç­–ç•¥å›æ¸¬ï¼ˆå¾Œç«¯æ“ä½œï¼Œ10 åˆ†é˜ï¼‰

  # 1. è¤‡è£½ç­–ç•¥ä»£ç¢¼
  docker compose cp /tmp/qlib_strategy_with_trained_model.py \
    backend:/app/scripts/

  # 2. åŸ·è¡Œç­–ç•¥æ¸¬è©¦
  docker compose exec backend python /app/scripts/qlib_strategy_with_trained_model.py

  # é æœŸè¼¸å‡ºï¼š
  # âœ… è¼‰å…¥è¨“ç·´å¥½çš„æ¨¡å‹
  # ============================================================
  # ç”Ÿæˆäº¤æ˜“ä¿¡è™Ÿ - 2023-12-15
  # ============================================================
  #   2330: 0.012345
  #   2317: 0.008234
  #   ...
  # è²·å…¥æ¸…å–® (Top 5):
  #   âœ… 2330: 0.012345
  #   âœ… 2454: 0.009876
  #   ...

  ---
  ğŸ“ˆ é æœŸçµæœ

  è¨“ç·´æŒ‡æ¨™

  | æŒ‡æ¨™     | ç›®æ¨™å€¼   | èªªæ˜                     |
  |----------|----------|--------------------------|
  | è¨“ç·´æå¤± | < 0.002  | MSE æå¤±                 |
  | é©—è­‰æå¤± | < 0.002  | é˜²æ­¢éæ“¬åˆ               |
  | æ¸¬è©¦ IC  | > 0.05   | é æ¸¬èƒ½åŠ›ï¼ˆ0.08+ ç‚ºå„ªç§€ï¼‰ |
  | è¨“ç·´æ™‚é–“ | 1-2 å°æ™‚ | å–æ±ºæ–¼æ•¸æ“šé‡å’Œç¡¬é«”       |

  å›æ¸¬æŒ‡æ¨™ï¼ˆé æœŸï¼‰

  | æŒ‡æ¨™         | é æœŸç¯„åœ   | èªªæ˜            |
  |--------------|------------|-----------------|
  | å¹´åŒ–å ±é…¬ç‡   | 15-25%     | åŸºæ–¼ Top 5 ç­–ç•¥ |
  | Sharpe Ratio | 1.5-2.5    | é¢¨éšªèª¿æ•´å¾Œæ”¶ç›Š  |
  | æœ€å¤§å›æ’¤     | -10 ~ -20% | æœ€å¤§è™§æ        |
  | å‹ç‡         | 55-65%     | é æ¸¬æ­£ç¢ºç‡      |

  ---
  ğŸ’¡ é—œéµè¦é»

  âœ… æˆåŠŸé—œéµ

  1. å› å­å“è³ªï¼šç¢ºä¿ RD-Agent ç”Ÿæˆçš„å› å­ IC > 0.03
  2. æ•¸æ“šå®Œæ•´æ€§ï¼šåŸ·è¡Œ bash scripts/sync-qlib-smart.sh
  3. æ¨¡å‹èª¿åƒï¼šæ ¹æ“šè¨“ç·´æ›²ç·šèª¿æ•´ hidden_dim, num_layers
  4. Early Stoppingï¼šé˜²æ­¢éæ“¬åˆï¼Œpatience=10

  âš ï¸ å¸¸è¦‹å•é¡Œ

  Q: è¨“ç·´æ™‚å‡ºç¾ "ç„¡æ³•ç²å–å› å­æ•¸æ“š"ï¼Ÿ
  # æª¢æŸ¥ Qlib æ•¸æ“š
  ls -lh /data/qlib/tw_stock_v2/features/2330/

  # é‡æ–°åŒæ­¥
  bash scripts/sync-qlib-smart.sh

  Q: æ¨¡å‹ IC å¤ªä½ï¼ˆ< 0.03ï¼‰ï¼Ÿ
  - æª¢æŸ¥å› å­è©•ä¼°çµæœï¼Œç§»é™¤ IC < 0 çš„å› å­
  - å¢åŠ è¿­ä»£æ¬¡æ•¸ï¼Œç”Ÿæˆæ›´å¤šå€™é¸å› å­
  - èª¿æ•´æ¨¡å‹æ¶æ§‹ï¼ˆå¢åŠ å±¤æ•¸ã€æ³¨æ„åŠ›é ­æ•¸ï¼‰

  Q: è¨“ç·´éç¨‹ä¸­ OOMï¼ˆè¨˜æ†¶é«”ä¸è¶³ï¼‰ï¼Ÿ
  # æ¸›å° batch_size
  batch_size = 32  # å¾ 64 æ”¹ç‚º 32

  # æˆ–æ¸›å°‘ hidden_dim
  hidden_dim = 64  # å¾ 128 æ”¹ç‚º 64
