âœ… ç¶²çµ¡é€£æ¥è¨ºæ–·èˆ‡ä¿®å¾©
# å¦‚æœç„¡æ³•å¾å¤–éƒ¨è¨ªå• http://122.116.152.55
# ç—‡ç‹€ï¼šERR_CONNECTION_TIMED_OUT

# 1. è¨ºæ–·å•é¡Œ
./scripts/diagnose-connection.sh

# 2. é–‹æ”¾æ‰€æœ‰å¿…è¦ç«¯å£ï¼ˆéœ€è¦ sudo æ¬Šé™ï¼‰
./scripts/open-all-ports.sh

# æ¸¬è©¦å¸³è™Ÿï¼š
# ç”¨æˆ¶åï¼švip_user
# å¯†ç¢¼ï¼štest123

âœ… é–‹ç™¼éšæ®µæ¸…é™¤æ‰€æœ‰çš„ç·©å­˜ï¼š
./scripts/quick-clean.sh
./scripts/reset-rate-limit.sh
./scripts/clear-frontend-cache.sh
docker compose restart backend celery-worker

âœ… è‡ªå‹•è£œé½Šæ‰€æœ‰ç¼ºå¤±è³‡æ–™çš„æŒ‡ä»¤
docker compose exec backend python scripts/check_and_fill_gaps.py --auto-fix --min-records 4500

âœ… ç›£æ§å›æ¸¬ , æ‰€æœ‰å·¥å…·éƒ½å·²å°±ç·’ï¼Œä½ å¯ä»¥éš¨æ™‚ç›£æ§ç³»çµ±ä¸­æ­£åœ¨åŸ·è¡Œçš„å›æ¸¬ä»»å‹™ï¼
# æ–¹æ³• 1: ä½¿ç”¨ç›£æ§è…³æœ¬ï¼ˆæœ€ç°¡å–®ï¼‰
./monitor_backtest_tasks.sh

âœ… åœ¨ Monaco Editor ä¸­ç·¨å¯«ä»£ç¢¼
2. æ¸¬è©¦è‡ªå‹•å®Œæˆï¼š
  - è¼¸å…¥ self. æŸ¥çœ‹å¯ç”¨å±¬æ€§
  - è¼¸å…¥ bt. æŸ¥çœ‹ Backtrader API
  - æŒ‰ Ctrl+Space æ‰‹å‹•è§¸ç™¼æç¤º

âœ… è‡ªå‹•åŒæ­¥æ’ç¨‹ï¼šå…± 7 å€‹

  1. sync-stock-list-daily - æ¯å¤© 08:00ï¼ˆåŒæ­¥è‚¡ç¥¨æ¸…å–®ï¼‰
  2. sync-daily-prices - æ¯å¤© 21:00ï¼ˆåŒæ­¥æ¯æ—¥åƒ¹æ ¼ï¼‰
  3. sync-ohlcv-daily - æ¯å¤© 22:00ï¼ˆåŒæ­¥ OHLCVï¼‰
  4. sync-latest-prices-frequent - äº¤æ˜“æ—¥æ¯ 15 åˆ†é˜ï¼ˆåŒæ­¥æœ€æ–°åƒ¹æ ¼ï¼‰
  5. cleanup-cache-daily - æ¯å¤© 03:00ï¼ˆæ¸…ç†å¿«å–ï¼‰
  6. sync-fundamental-weekly - æ¯é€±æ—¥ 04:00ï¼ˆå®Œæ•´è²¡å‹™åŒæ­¥ï¼‰
  7. sync-fundamental-latest-daily - æ¯å¤© 23:00ï¼ˆå¿«é€Ÿè²¡å‹™åŒæ­¥ï¼‰

  ğŸš€ æ‰‹å‹•åŸ·è¡Œæ–¹å¼

  æœ€ç°¡å–®çš„æ–¹å¼ï¼ˆäº’å‹•å¼é¸å–®ï¼‰ï¼š
  cd /data/CCTest/QuantLab
  ./scripts/manual-sync.sh

  å¿«é€ŸåŸ·è¡Œç‰¹å®šä»»å‹™ï¼š
  # åŒæ­¥è²¡å‹™æŒ‡æ¨™ï¼ˆå®Œæ•´ç‰ˆ - 8æª”è‚¡ç¥¨ï¼‰
  ./scripts/manual-sync.sh fundamental

  # åŒæ­¥è²¡å‹™æŒ‡æ¨™ï¼ˆå¿«é€Ÿç‰ˆ - 5æª”è‚¡ç¥¨ï¼‰  
  ./scripts/manual-sync.sh fundamental-latest

  # åŸ·è¡Œæ‰€æœ‰åŒæ­¥
  ./scripts/manual-sync.sh all

  # æŸ¥çœ‹ä»»å‹™ç‹€æ…‹
  ./scripts/manual-sync.sh status

  ğŸ“Š ç›£æ§å‘½ä»¤

  # æŸ¥çœ‹ Celery æœå‹™ç‹€æ…‹
  docker compose ps celery-beat celery-worker

  # æŸ¥çœ‹æ­£åœ¨åŸ·è¡Œçš„ä»»å‹™
  docker compose exec backend celery -A app.core.celery_app inspect active

  # å³æ™‚æŸ¥çœ‹æ—¥èªŒ
  docker compose logs -f celery-worker

âœ… è‚¡ç¥¨çš„è²¡å‹™æŒ‡æ¨™
  # 1. é‡ç½®é€²åº¦ï¼ˆæ¸…é™¤èˆŠæ•¸æ“šï¼‰
  docker compose exec backend rm -f /tmp/batch_sync_progress.json

  # 2. é–‹å§‹æ‰¹æ¬¡åŒæ­¥
  ./scripts/batch-sync.sh æœƒè‡ªå‹•çºŒå‚³
  ./scripts/monitor-batch-sync.sh

âœ… åŒæ­¥å¾Œé‡æ–°è½‰æ›ç‚º Qlib æ ¼å¼ï¼ˆæ™ºæ…§å¢é‡åŒæ­¥ï¼‰
  ./scripts/sync-qlib-smart.sh

git init
git status
git add . 
git remote add origin http://git.dama168.com:3000/robert/QLab.git
git commit -m "message"             
git push origin master
æ”¾æ£„ä¿®æ”¹
git checkout .    

âœ… è¨ªå• http://localhost:3000/rdagent æ¸¬è©¦å‰ç«¯ä»‹é¢
  

âœ… å»ºç«‹äº†ä¸€å€‹è‡ªå‹•åŒ–æ¸¬è©¦è…³æœ¬ test_rdagent_integration.shï¼Œå®ƒæœƒåŸ·è¡Œä»¥ä¸‹ 7 å€‹æ­¥é©Ÿï¼š

  æ¸¬è©¦æµç¨‹ï¼š

  1. âœ… æª¢æŸ¥æœå‹™ç‹€æ…‹ - é©—è­‰ Docker å®¹å™¨ã€Backend APIã€Celery Worker
  2. ğŸ‘¤ æº–å‚™æ¸¬è©¦ç”¨æˆ¶ - è¨»å†Š/ç™»å…¥æ¸¬è©¦å¸³è™Ÿï¼Œç²å– JWT Token
  3. ğŸš€ å‰µå»ºå› å­æŒ–æ˜ä»»å‹™ - é€šé API æäº¤ä»»å‹™
  4. â±ï¸  ç›£æ§ä»»å‹™åŸ·è¡Œ - å¯¦æ™‚ç›£æ§ Celery æ—¥èªŒï¼Œè¼ªè©¢ä»»å‹™ç‹€æ…‹
  5. ğŸ“Š æª¢æŸ¥ä»»å‹™çµæœ - æŸ¥çœ‹ç”Ÿæˆçš„å› å­ã€LLM èª¿ç”¨ã€æˆæœ¬
  6. ğŸ—„ï¸  æª¢æŸ¥è³‡æ–™åº« - é©—è­‰å› å­æ­£ç¢ºå„²å­˜
  7. ğŸ“ æ¸¬è©¦ç¸½çµ - é¡¯ç¤ºå®Œæ•´çš„æ¸¬è©¦çµæœ

âœ…  é–‹ç™¼/æ¸¬è©¦æ™‚ï¼š
  # å¿«é€Ÿé‡ç½®ï¼ˆæ¨è–¦ï¼‰
  ./scripts/reset-rate-limit-quick.sh
  # æˆ–ä½¿ç”¨äº’å‹•å¼ï¼ˆéœ€è¦ç²¾ç¢ºæ§åˆ¶æ™‚ï¼‰
  ./scripts/reset-rate-limit.sh


âœ… æ–°çš„å› å­ï¼š
  1. momentum_5d_volume_adjusted (ID: 1)
    - æè¿°ï¼š5æ—¥å‹•é‡ç¶“æˆäº¤é‡èª¿æ•´
    - å…¬å¼ï¼š($close / Ref($close, 5) - 1) * Log($volume / Mean($volume, 20))
    - åˆ†é¡ï¼šmomentum
  2. volatility_ratio_normalized (ID: 2)
    - æè¿°ï¼š20æ—¥æ³¢å‹•ç‡æ¨™æº–åŒ–
    - å…¬å¼ï¼šStd($close, 20) / Mean($close, 20)
    - åˆ†é¡ï¼švolatility

å‰µå»ºå› å­
å°‹æ‰¾èƒ½é æ¸¬æœªä¾†äº”æ—¥å ±é…¬ç‡çš„å‹•é‡å› å­ï¼Œçµåˆæˆäº¤é‡æŒ‡æ¨™ï¼Œè·Ÿ30æ—¥ï¼Œ15æ—¥ç§»å‹•å¹³å‡ç·šï¼Œè·ŸMACDï¼ŒKDã€‚

å‰µå»ºå› å­
æˆ‘çš„å› å­éˆæ„Ÿæ˜¯ï¼šç•¶è‚¡ç¥¨åœ¨éå»çŸ­æœŸå…§æ€¥åŠ‡ä¸Šæ¼²**ï¼ˆè¶…è²·ï¼‰ï¼Œä½†æˆäº¤é‡ä¸¦æœªåŒæ­¥æ”¾å¤§æ™‚ï¼Œé€™å¯èƒ½æ˜¯ä¸€å€‹è™›å‡ç¹æ¦®æˆ–è€—ç›¡æ€§è²·å…¥çš„ä¿¡è™Ÿï¼Œé ç¤ºè‘—çŸ­æœŸå…§å°‡ç™¼ç”Ÿåè½‰ä¸‹è·Œã€‚

å‰µå»ºå› å­
My factor-based inspiration is that when a stock has risen sharply in the past short period (overbought) but the trading volume has not increased accordingly, this may be a signal of a false boom or exhaustion buying, indicating that a reversal and decline will occur in the short term.


âœ… è¨ªå•å„å€‹ç›£æ§ä»‹é¢
  é‹è¡Œ ./start-monitoring.sh é«”é©—ç›£æ§ç³»çµ± 
  
  Grafana: http://122.116.152.55:3001
  Prometheus: http://122.116.152.55:9090
  Backend Metrics: http://122.116.152.55:8000/metrics
  Celery Metrics: http://122.116.152.55:9808/metrics

  # å¦‚æœéœ€è¦ï¼Œé–‹æ”¾ç«¯å£
  sudo ufw allow 9090/tcp
  sudo ufw allow 9808/tcp

  # é‡ç½®å¾Œå° grafana admin çš„å¯†ç¢¼ ç‚º
  docker compose exec grafana grafana cli admin reset-admin-password jsXdke82SYk.aji8

âœ… ä¸»è¦æ˜¯åŸ·è¡Œ ./start_shioaji_import.sh incremental
  æœƒå»åŸ·è¡Œ
  ./scripts/import_all_shioaji.sh $INCREMENTAL_FLAG &
  å†å»åŸ·è¡Œ
  app/scripts/import_shioaji_csv.py
  ç›£æ§
  ./scripts/monitor_shioaji_import.sh


âœ… æ™ºæ…§å¢é‡è½‰æ› , å°‡ PostgreSQL çš„åˆ†é˜ç·šè½‰æ›åˆ° qlib åº•ä¸‹
  docker compose exec backend python scripts/export_minute_to_qlib.py \
      --output-dir /data/qlib/tw_stock_minute \
      --smart

âœ… é€£ç·š Shioaji API , è£œé½Š PostgreSql & qlib åº•ä¸‹çš„æ‰€æœ‰ä¸€åˆ†é˜ç·šè³‡æ–™ 
sync_shioaji_to_qlib.py
nohup docker compose exec -T backend python /app/scripts/sync_shioaji_to_qlib.py --smart > /tmp/shioaji_sync.log 2>&1 &

âœ… å‚™ä»½è³‡æ–™åº« PostgreSQL
docker compose exec -T postgres pg_dump -U quantlab quantlab | gzip > /home/ubuntu/QuantLab/backups/quantlab_$(date +%Y%m%d).sql.gz

âœ… å¦‚ä½•é‡æ–°åŒæ­¥ Qlib è³‡æ–™
  # æ™ºæ…§åŒæ­¥æ‰€æœ‰è‚¡ç¥¨ï¼ˆ1-5 åˆ†é˜ï¼‰
  bash /home/ubuntu/QuantLab/scripts/sync-qlib-smart.sh

  # åˆªé™¤èˆŠè³‡æ–™ï¼ˆè¬¹æ…ï¼ï¼‰
  docker compose exec backend rm -rf /data/qlib/tw_stock_v2/*

  # å®Œæ•´å°å‡ºæ‰€æœ‰è‚¡ç¥¨
  docker compose exec backend python /app/scripts/export_to_qlib_v2.py \
    --output-dir /data/qlib/tw_stock_v2 \
    --stocks all

  # å¾å®¹å™¨è¤‡è£½å‡ºä¾†ä¸¦å£“ç¸®
  docker compose cp backend:/data/qlib/tw_stock_v2 /tmp/qlib_backup
  tar -czf /home/ubuntu/QuantLab/backups/qlib_data_$(date +%Y%m%d).tar.gz -C /tmp qlib_backup
  rm -rf /tmp/qlib_backup

  ğŸ”„ å¾å‚™ä»½é‚„åŸ
  # è§£å£“ç¸®
  tar -xzf /home/ubuntu/QuantLab/backups/qlib_data_20241213.tar.gz -C /tmp/
  # è¤‡è£½å›å®¹å™¨
  docker compose cp /tmp/qlib_backup/tw_stock_v2 backend:/data/qlib/
  # é©—è­‰
  docker compose exec backend ls -lh /data/qlib/tw_stock_v2/

âœ… è¿è¡Œæ‰€æœ‰è´¨é‡æ£€æŸ¥ï¼ˆå¿«é€Ÿæ¨¡å¼ï¼‰
  docker compose exec backend python /app/scripts/run_all_tests.py --quick

âœ…
  # æŸ¥çœ‹æ—¥èªŒ
  docker compose logs -f telegram-bot
  # é‡å•Ÿæœå‹™
  docker compose restart telegram-bot
  # åœæ­¢æœå‹™
  docker compose stop telegram-bot

âœ… é€™å€‹éƒ½å·²ç¶“è‡ªå‹•åŒ–äº†
  # 1. è¨»å†Šæœˆä»½åˆç´„ï¼ˆåƒ…éœ€ä¸€æ¬¡ï¼‰
  docker compose exec backend python /app/scripts/register_futures_contracts.py
  # 2. åŒæ­¥æ•¸æ“š
  docker compose exec backend python /app/scripts/sync_shioaji_to_qlib.py --stocks TX --smart
  # 3. ç”Ÿæˆé€£çºŒåˆç´„
  docker compose exec backend python /app/scripts/generate_continuous_contract.py --symbol TX --start-date 2025-12-01 --end-date 2025-12-31
  


âœ… # ç¬¬ä¸€æ­¥ï¼šæ¸¬è©¦å›è£œï¼ˆç¢ºèªåŠŸèƒ½æ­£å¸¸ï¼‰
  docker compose exec backend python scripts/backfill_option_data.py \
    --days-back 3 \
    --dry-run
  # ç¬¬äºŒæ­¥ï¼šå›è£œæœ€è¿‘ 1 é€±
  docker compose exec backend python scripts/backfill_option_data.py \
    --days-back 7
  # ç¬¬ä¸‰æ­¥ï¼šæ ¹æ“šéœ€è¦é€æ­¥å›è£œæ›´é•·æ™‚é–“
  docker compose exec backend python scripts/backfill_option_data.py \
    --days-back 30

  docker compose exec backend python scripts/backfill_option_data.py \
    --underlying TX \
    --days-back 90

âœ… backend é‡å•Ÿå¾Œè‡ªå‹•æª¢æ¸¬ä¸¦é‡æ–°è§¸ç™¼ä»Šå¤©æ‡‰è©²åŸ·è¡Œä½†è¢«æ’¤éŠ·çš„ä»»å‹™ã€‚
  å¶è€Œé‡å•Ÿ
  scripts/retry-missed-tasks.sh

  # 4. æŸ¥çœ‹åŸ·è¡Œçµæœ
  docker compose logs -f celery-worker | grep -E 'succeeded|failed'

  é »ç¹é‡å•Ÿ , å…¨è‡ªå‹• , æœƒå›ºå®šä¸€ç›´ç›£æ¸¬
  scripts/auto-retry-after-restart.sh

  æŸ¥çœ‹ä»»å‹™çš„ Log
  docker compose logs -f celery-worker celery-beat --tail 10

âœ… å‰µå»ºæˆ–ç·¨è¼¯ç­–ç•¥æ™‚ï¼Œåœ¨ã€Œç­–ç•¥åƒæ•¸ã€ä¸­æ·»åŠ ï¼š

  {
    "short_ma": 5,
    "long_ma": 20,
    "stocks": ["2330", "2317", "2454"]
  }

  å¦‚æœæ‚¨æƒ³ç›£æ§å°æŒ‡æœŸè²¨å’Œå°å°æœŸè²¨ï¼š

  {
    "stocks": ["TX", "MTX", "TXCONT", "MTXCONT"]
  }

  èªªæ˜ï¼š
  - TX, MTX - æœˆä»½åˆç´„ï¼ˆæœƒè‡ªå‹•æ›æœˆï¼‰
  - TXCONT, MTXCONT - é€£çºŒåˆç´„ï¼ˆç„¡åˆ°æœŸæ—¥ï¼‰
  - æœŸè²¨ç­–ç•¥ï¼šé…ç½® ["TX", "MTX"] æˆ– ["TXCONT"]
  - é¸æ“‡æ¬Šç­–ç•¥ï¼šé…ç½® ["TX"]ï¼ˆé¸æ“‡æ¬Šæ¨™çš„ï¼‰

âœ… é‡æ–°æ§‹å»ºä¸¦å•Ÿå‹•ï¼ˆå¦‚æœæƒ³ç¢ºä¿æ‰€æœ‰è®Šæ›´ç”Ÿæ•ˆï¼‰
  docker compose down
  docker compose up -d --build

âœ… # é€²å…¥ PostgreSQL äº’å‹•å¼ä»‹é¢
  docker compose exec postgres psql -U quantlab quantlab
