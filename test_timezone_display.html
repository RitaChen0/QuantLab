<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>æ™‚å€é¡¯ç¤ºæ¸¬è©¦</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1, h2 {
            color: #333;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background: #f0f0f0;
            font-weight: bold;
        }
        .utc {
            color: #666;
            font-family: monospace;
        }
        .taiwan {
            color: #059669;
            font-weight: bold;
        }
        .success {
            color: #10b981;
        }
        .info {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 15px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <h1>ğŸ• æ™‚å€è½‰æ›æ¸¬è©¦</h1>

    <div class="info">
        <strong>æ¸¬è©¦ç›®çš„ï¼š</strong>é©—è­‰å¾Œç«¯ UTC æ™‚é–“åœ¨å‰ç«¯æ­£ç¢ºè½‰æ›ç‚ºå°ç£æ™‚é–“ï¼ˆUTC+8ï¼‰
    </div>

    <div class="test-section">
        <h2>æ¸¬è©¦æ¡ˆä¾‹</h2>
        <table id="test-table">
            <thead>
                <tr>
                    <th>å¾Œç«¯è¿”å›ï¼ˆUTCï¼‰</th>
                    <th>å‰ç«¯é¡¯ç¤ºï¼ˆå°ç£æ™‚é–“ï¼‰</th>
                    <th>é æœŸçµæœ</th>
                    <th>ç‹€æ…‹</th>
                </tr>
            </thead>
            <tbody id="test-results">
            </tbody>
        </table>
    </div>

    <div class="test-section">
        <h2>ç•¶å‰æ™‚é–“</h2>
        <table>
            <tr>
                <th>æ™‚å€</th>
                <th>æ™‚é–“</th>
            </tr>
            <tr>
                <td>UTC</td>
                <td class="utc" id="current-utc"></td>
            </tr>
            <tr>
                <td>å°ç£æ™‚é–“ (Asia/Taipei)</td>
                <td class="taiwan" id="current-taiwan"></td>
            </tr>
        </table>
    </div>

    <script>
        // æ¨¡æ“¬å‰ç«¯çš„ formatToTaiwanTime å‡½æ•¸
        function formatToTaiwanTime(dateStr) {
            if (!dateStr) return '-';

            const date = new Date(dateStr);

            if (isNaN(date.getTime())) {
                return '-';
            }

            return date.toLocaleString('zh-TW', {
                timeZone: 'Asia/Taipei',
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
        }

        // æ¸¬è©¦æ¡ˆä¾‹
        const testCases = [
            {
                utc: '2025-12-20T00:18:21+00:00',
                expected: '2025/12/20 08:18:21',
                description: 'Celery ä»»å‹™åŸ·è¡Œæ™‚é–“'
            },
            {
                utc: '2025-12-19T19:00:00+00:00',
                expected: '2025/12/20 03:00:00',
                description: 'æ¸…ç†å¿«å–ä»»å‹™ï¼ˆå°ç£æ™‚é–“ 03:00ï¼‰'
            },
            {
                utc: '2025-12-19T21:00:00+00:00',
                expected: '2025/12/20 05:00:00',
                description: 'æ¸…ç† Celery å…ƒæ•¸æ“šï¼ˆå°ç£æ™‚é–“ 05:00ï¼‰'
            },
            {
                utc: '2025-12-20T00:00:00+00:00',
                expected: '2025/12/20 08:00:00',
                description: 'åŒæ­¥è‚¡ç¥¨æ¸…å–®ï¼ˆå°ç£æ™‚é–“ 08:00ï¼‰'
            },
            {
                utc: '2025-12-20T01:00:00+00:00',
                expected: '2025/12/20 09:00:00',
                description: 'äº¤æ˜“æ™‚æ®µåƒ¹æ ¼åŒæ­¥ï¼ˆå°ç£æ™‚é–“ 09:00ï¼‰'
            },
            {
                utc: '2025-12-20T07:00:00+00:00',
                expected: '2025/12/20 15:00:00',
                description: 'Shioaji åˆ†é˜ç·šåŒæ­¥ï¼ˆå°ç£æ™‚é–“ 15:00ï¼‰'
            },
            {
                utc: '2025-12-20T13:00:00+00:00',
                expected: '2025/12/20 21:00:00',
                description: 'æ¯æ—¥åƒ¹æ ¼åŒæ­¥ï¼ˆå°ç£æ™‚é–“ 21:00ï¼‰'
            }
        ];

        // åŸ·è¡Œæ¸¬è©¦
        const tbody = document.getElementById('test-results');
        testCases.forEach(testCase => {
            const result = formatToTaiwanTime(testCase.utc);
            const passed = result === testCase.expected;

            const row = document.createElement('tr');
            row.innerHTML = `
                <td class="utc">${testCase.utc}<br><small>${testCase.description}</small></td>
                <td class="taiwan">${result}</td>
                <td>${testCase.expected}</td>
                <td class="success">${passed ? 'âœ… é€šé' : 'âŒ å¤±æ•—'}</td>
            `;
            tbody.appendChild(row);
        });

        // æ›´æ–°ç•¶å‰æ™‚é–“
        function updateCurrentTime() {
            const now = new Date();

            const utcTime = now.toISOString();
            document.getElementById('current-utc').textContent = utcTime;

            const taiwanTime = now.toLocaleString('zh-TW', {
                timeZone: 'Asia/Taipei',
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
            document.getElementById('current-taiwan').textContent = taiwanTime;
        }

        updateCurrentTime();
        setInterval(updateCurrentTime, 1000);
    </script>
</body>
</html>
